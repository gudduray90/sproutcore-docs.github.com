<html><head><meta http-equiv="content-type" content="text/html; charset=utf8"> <style>
	.KEYW {color: #933;}
	.COMM {color: #bbb; font-style: italic;}
	.NUMB {color: #393;}
	.STRN {color: #393;}
	.REGX {color: #339;}
	.line {border-right: 1px dotted #666; color: #666; font-style: normal;}
	</style></head><body><pre><span class='line'>  1</span> <span class="COMM">// ==========================================================================</span><span class="WHIT">
<span class='line'>  2</span> </span><span class="COMM">// Project:   SproutCore - JavaScript Application Framework</span><span class="WHIT">
<span class='line'>  3</span> </span><span class="COMM">// Copyright: ©2006-2011 Strobe Inc. and contributors.</span><span class="WHIT">
<span class='line'>  4</span> </span><span class="COMM">//            Portions ©2008-2011 Apple Inc. All rights reserved.</span><span class="WHIT">
<span class='line'>  5</span> </span><span class="COMM">// License:   Licensed under MIT license (see license.js)</span><span class="WHIT">
<span class='line'>  6</span> </span><span class="COMM">// ==========================================================================</span><span class="WHIT">
<span class='line'>  7</span> </span><span class="COMM">/*global jQuery*/</span><span class="WHIT">
<span class='line'>  8</span> 
<span class='line'>  9</span> </span><span class="NAME">sc_require</span><span class="PUNC">(</span><span class="STRN">'system/browser'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 10</span> </span><span class="NAME">sc_require</span><span class="PUNC">(</span><span class="STRN">'system/event'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 11</span> </span><span class="NAME">sc_require</span><span class="PUNC">(</span><span class="STRN">'system/cursor'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 12</span> </span><span class="NAME">sc_require</span><span class="PUNC">(</span><span class="STRN">'system/responder'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 13</span> </span><span class="NAME">sc_require</span><span class="PUNC">(</span><span class="STRN">'system/theme'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 14</span> 
<span class='line'> 15</span> </span><span class="NAME">sc_require</span><span class="PUNC">(</span><span class="STRN">'system/string'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 16</span> </span><span class="NAME">sc_require</span><span class="PUNC">(</span><span class="STRN">'views/view/statechart'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 17</span> 
<span class='line'> 18</span> 
<span class='line'> 19</span> </span><span class="COMM">/**
<span class='line'> 20</span>   Default property to disable or enable by default the contextMenu
<span class='line'> 21</span> */</span><span class="WHIT">
<span class='line'> 22</span> </span><span class="NAME">SC.CONTEXT_MENU_ENABLED</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 23</span> 
<span class='line'> 24</span> </span><span class="COMM">/**
<span class='line'> 25</span>   Default property to disable or enable if the focus can jump to the address
<span class='line'> 26</span>   bar or not.
<span class='line'> 27</span> */</span><span class="WHIT">
<span class='line'> 28</span> </span><span class="NAME">SC.TABBING_ONLY_INSIDE_DOCUMENT</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 29</span> 
<span class='line'> 30</span> </span><span class="COMM">/**
<span class='line'> 31</span>   Tells the property (when fetched with themed()) to get its value from the renderer (if any).
<span class='line'> 32</span> */</span><span class="WHIT">
<span class='line'> 33</span> </span><span class="NAME">SC.FROM_THEME</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"__FROM_THEME__"</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// doesn't really matter what it is, so long as it is unique. Readability is a plus.</span><span class="WHIT">
<span class='line'> 34</span> 
<span class='line'> 35</span> </span><span class="COMM">/** @private - custom array used for child views */</span><span class="WHIT">
<span class='line'> 36</span> </span><span class="NAME">SC.EMPTY_CHILD_VIEWS_ARRAY</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 37</span> </span><span class="NAME">SC.EMPTY_CHILD_VIEWS_ARRAY.needsClone</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 38</span> 
<span class='line'> 39</span> </span><span class="COMM">/**
<span class='line'> 40</span>   @class
<span class='line'> 41</span> 
<span class='line'> 42</span> */</span><span class="WHIT">
<span class='line'> 43</span> </span><span class="NAME">SC.CoreView.reopen</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'> 44</span> </span><span class="COMM">/** @scope SC.View.prototype */</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 45</span> 
<span class='line'> 46</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'> 47</span>     An array of the properties of this class that will be concatenated when
<span class='line'> 48</span>     also present on subclasses.
<span class='line'> 49</span> 
<span class='line'> 50</span>     @type Array
<span class='line'> 51</span>     @default ['outlets', 'displayProperties', 'classNames', 'renderMixin', 'didCreateLayerMixin', 'willDestroyLayerMixin', 'classNameBindings', 'attributeBindings']
<span class='line'> 52</span>   */</span><span class="WHIT">
<span class='line'> 53</span> </span><span class="WHIT">  </span><span class="NAME">concatenatedProperties</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="STRN">'outlets'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'displayProperties'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'classNames'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'renderMixin'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'didCreateLayerMixin'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'willDestroyLayerMixin'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'classNameBindings'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'attributeBindings'</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 54</span> 
<span class='line'> 55</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'> 56</span>     The WAI-ARIA role of the control represented by this view. For example, a
<span class='line'> 57</span>     button may have a role of type 'button', or a pane may have a role of
<span class='line'> 58</span>     type 'alertdialog'. This property is used by assistive software to help
<span class='line'> 59</span>     visually challenged users navigate rich web applications.
<span class='line'> 60</span> 
<span class='line'> 61</span>     The full list of valid WAI-ARIA roles is available at:
<span class='line'> 62</span>     http://www.w3.org/TR/wai-aria/roles#roles_categorization
<span class='line'> 63</span> 
<span class='line'> 64</span>     @type String
<span class='line'> 65</span>     @default null
<span class='line'> 66</span>   */</span><span class="WHIT">
<span class='line'> 67</span> </span><span class="WHIT">  </span><span class="NAME">ariaRole</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 68</span> 
<span class='line'> 69</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'> 70</span>     The aria-hidden role is managed appropriately by the internal view's
<span class='line'> 71</span>     statechart.  When the view is not currently displayed the aria-hidden
<span class='line'> 72</span>     attribute will be set to true.
<span class='line'> 73</span> 
<span class='line'> 74</span>     @type String
<span class='line'> 75</span>     @default null
<span class='line'> 76</span>     @deprecated Version 1.10
<span class='line'> 77</span>   */</span><span class="WHIT">
<span class='line'> 78</span> </span><span class="WHIT">  </span><span class="NAME">ariaHidden</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 79</span> 
<span class='line'> 80</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'> 81</span>     Whether this view was created by its parent view or not.
<span class='line'> 82</span> 
<span class='line'> 83</span>     Several views are given child view classes or instances to automatically
<span class='line'> 84</span>     append and remove.  In the case that the view was provided an instance,
<span class='line'> 85</span>     when it removes the instance and no longer needs it, it should not destroy
<span class='line'> 86</span>     the instance because it was created by someone else.
<span class='line'> 87</span> 
<span class='line'> 88</span>     On the other hand if the view was given a class that it creates internal
<span class='line'> 89</span>     instances from, then it should destroy those instances properly to avoid
<span class='line'> 90</span>     memory leaks.
<span class='line'> 91</span> 
<span class='line'> 92</span>     This property should be set by any view that is creating internal child
<span class='line'> 93</span>     views so that it can properly remove them later.  Note that if you use
<span class='line'> 94</span>     `createChildView`, this property is set automatically for you.
<span class='line'> 95</span> 
<span class='line'> 96</span>     @type Boolean
<span class='line'> 97</span>     @see SC.View#createChildView
<span class='line'> 98</span>     @default false
<span class='line'> 99</span>   */</span><span class="WHIT">
<span class='line'>100</span> </span><span class="WHIT">  </span><span class="NAME">createdByParent</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>101</span> 
<span class='line'>102</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>103</span>     The current pane.
<span class='line'>104</span> 
<span class='line'>105</span>     @field
<span class='line'>106</span>     @type SC.Pane
<span class='line'>107</span>     @default null
<span class='line'>108</span>   */</span><span class="WHIT">
<span class='line'>109</span> </span><span class="WHIT">  </span><span class="NAME">pane</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>110</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">view</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>111</span> 
<span class='line'>112</span> </span><span class="WHIT">    </span><span class="KEYW">while</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">view</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">view.isPane</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">view</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">view.get</span><span class="PUNC">(</span><span class="STRN">'parentView'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>113</span> 
<span class='line'>114</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">view</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>115</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">.</span><span class="NAME">property</span><span class="PUNC">(</span><span class="STRN">'parentView'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">cacheable</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>116</span> 
<span class='line'>117</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>118</span>     The page this view was instantiated from.  This is set by the page object
<span class='line'>119</span>     during instantiation.
<span class='line'>120</span> 
<span class='line'>121</span>     @type SC.Page
<span class='line'>122</span>     @default null
<span class='line'>123</span>   */</span><span class="WHIT">
<span class='line'>124</span> </span><span class="WHIT">  </span><span class="NAME">page</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>125</span> 
<span class='line'>126</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>127</span>     If the view is currently inserted into the DOM of a parent view, this
<span class='line'>128</span>     property will point to the parent of the view.
<span class='line'>129</span> 
<span class='line'>130</span>     @type SC.View
<span class='line'>131</span>     @default null
<span class='line'>132</span>   */</span><span class="WHIT">
<span class='line'>133</span> </span><span class="WHIT">  </span><span class="NAME">parentView</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>134</span> 
<span class='line'>135</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>136</span>     The isVisible property determines if the view should be displayed or not.
<span class='line'>137</span> 
<span class='line'>138</span>     If you also set a transitionShow or transitionHide plugin, then when
<span class='line'>139</span>     isVisible changes, the appropriate transition will execute as the view's
<span class='line'>140</span>     visibility changes.
<span class='line'>141</span> 
<span class='line'>142</span>     Note that isVisible can be set to true and the view may still not be
<span class='line'>143</span>     "visible" in the window.  This can occur if:
<span class='line'>144</span> 
<span class='line'>145</span>       1. the view is not attached to the document.
<span class='line'>146</span>       2. the view has a view ancestor with isVisible set to false.
<span class='line'>147</span> 
<span class='line'>148</span>     @type Boolean
<span class='line'>149</span>     @see SC.View#viewState
<span class='line'>150</span>     @default true
<span class='line'>151</span>   */</span><span class="WHIT">
<span class='line'>152</span> </span><span class="WHIT">  </span><span class="NAME">isVisible</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>153</span> </span><span class="WHIT">  </span><span class="NAME">isVisibleBindingDefault</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">SC.Binding.bool</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>154</span> 
<span class='line'>155</span> </span><span class="WHIT">  </span><span class="COMM">// ..........................................................</span><span class="WHIT">
<span class='line'>156</span> </span><span class="WHIT">  </span><span class="COMM">// CHILD VIEW SUPPORT</span><span class="WHIT">
<span class='line'>157</span> </span><span class="WHIT">  </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>158</span> 
<span class='line'>159</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>160</span>     Array of child views.  You should never edit this array directly unless
<span class='line'>161</span>     you are implementing createChildViews().  Most of the time, you should
<span class='line'>162</span>     use the accessor methods such as appendChild(), insertBefore() and
<span class='line'>163</span>     removeChild().
<span class='line'>164</span> 
<span class='line'>165</span>     @type Array
<span class='line'>166</span>     @default []
<span class='line'>167</span>   */</span><span class="WHIT">
<span class='line'>168</span> </span><span class="WHIT">  </span><span class="NAME">childViews</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">SC.EMPTY_CHILD_VIEWS_ARRAY</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>169</span> 
<span class='line'>170</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>171</span>     Use this property to automatically mix in a collection of mixins into all
<span class='line'>172</span>     child views created by the view. This collection is applied during createChildView
<span class='line'>173</span>     @property
<span class='line'>174</span> 
<span class='line'>175</span>     @type Array
<span class='line'>176</span>     @default null
<span class='line'>177</span>   */</span><span class="WHIT">
<span class='line'>178</span> </span><span class="WHIT">  </span><span class="NAME">autoMixins</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>179</span> 
<span class='line'>180</span> </span><span class="WHIT">  </span><span class="COMM">// ..........................................................</span><span class="WHIT">
<span class='line'>181</span> </span><span class="WHIT">  </span><span class="COMM">// LAYER SUPPORT</span><span class="WHIT">
<span class='line'>182</span> </span><span class="WHIT">  </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>183</span> 
<span class='line'>184</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>185</span>     Returns the current layer for the view.  The layer for a view is only
<span class='line'>186</span>     generated when the view first becomes visible in the window and even
<span class='line'>187</span>     then it will not be computed until you request this layer property.
<span class='line'>188</span> 
<span class='line'>189</span>     If the layer is not actually set on the view itself, then the layer will
<span class='line'>190</span>     be found by calling this.findLayerInParentLayer().
<span class='line'>191</span> 
<span class='line'>192</span>     You can also set the layer by calling set on this property.
<span class='line'>193</span> 
<span class='line'>194</span>     @type DOMElement the layer
<span class='line'>195</span>   */</span><span class="WHIT">
<span class='line'>196</span> </span><span class="WHIT">  </span><span class="NAME">layer</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>197</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>198</span> </span><span class="WHIT">      </span><span class="NAME">this._view_layer</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>199</span> 
<span class='line'>200</span> </span><span class="WHIT">    </span><span class="COMM">// no layer...attempt to discover it...</span><span class="WHIT">
<span class='line'>201</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>202</span> </span><span class="WHIT">      </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._view_layer</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>203</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>204</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'parentView'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>205</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">parent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parent.get</span><span class="PUNC">(</span><span class="STRN">'layer'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>206</span> </span><span class="WHIT">        </span><span class="NAME">this._view_layer</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.findLayerInParentLayer</span><span class="PUNC">(</span><span class="NAME">parent</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>207</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>208</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>209</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>210</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">.</span><span class="NAME">property</span><span class="PUNC">(</span><span class="STRN">'isVisibleInWindow'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">cacheable</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>211</span> 
<span class='line'>212</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>213</span>     Get a CoreQuery object for this view's layer, or pass in a selector string
<span class='line'>214</span>     to get a CoreQuery object for a DOM node nested within this layer.
<span class='line'>215</span> 
<span class='line'>216</span>     @param {String} sel a CoreQuery-compatible selector string
<span class='line'>217</span>     @returns {SC.CoreQuery} the CoreQuery object for the DOM node
<span class='line'>218</span>   */</span><span class="WHIT">
<span class='line'>219</span> </span><span class="WHIT">  </span><span class="NAME">$</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">sel</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>220</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">layer</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'layer'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>221</span> 
<span class='line'>222</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">layer</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">SC.$</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>223</span> </span><span class="WHIT">    </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">sel</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">SC.$</span><span class="PUNC">(</span><span class="NAME">layer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>224</span> </span><span class="WHIT">    </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">SC.$</span><span class="PUNC">(</span><span class="NAME">sel</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">layer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>225</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>226</span> 
<span class='line'>227</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>228</span>     Returns the DOM element that should be used to hold child views when they
<span class='line'>229</span>     are added/remove via DOM manipulation.  The default implementation simply
<span class='line'>230</span>     returns the layer itself.  You can override this to return a DOM element
<span class='line'>231</span>     within the layer.
<span class='line'>232</span> 
<span class='line'>233</span>     @type DOMElement the container layer
<span class='line'>234</span>   */</span><span class="WHIT">
<span class='line'>235</span> </span><span class="WHIT">  </span><span class="NAME">containerLayer</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>236</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'layer'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>237</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">.</span><span class="NAME">property</span><span class="PUNC">(</span><span class="STRN">'layer'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">cacheable</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>238</span> 
<span class='line'>239</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>240</span>     The ID to use when trying to locate the layer in the DOM.  If you do not
<span class='line'>241</span>     set the layerId explicitly, then the view's GUID will be used instead.
<span class='line'>242</span>     This ID must be set at the time the view is created.
<span class='line'>243</span> 
<span class='line'>244</span>     @type String
<span class='line'>245</span>     @readOnly
<span class='line'>246</span>   */</span><span class="WHIT">
<span class='line'>247</span> </span><span class="WHIT">  </span><span class="NAME">layerId</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>248</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this._layerId</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>249</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._layerId</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._layerId</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>250</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">SC.guidFor</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>251</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">.</span><span class="NAME">property</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">cacheable</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>252</span> 
<span class='line'>253</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>254</span>     Attempts to discover the layer in the parent layer.  The default
<span class='line'>255</span>     implementation looks for an element with an ID of layerId (or the view's
<span class='line'>256</span>     guid if layerId is null).  You can override this method to provide your
<span class='line'>257</span>     own form of lookup.  For example, if you want to discover your layer using
<span class='line'>258</span>     a CSS class name instead of an ID.
<span class='line'>259</span> 
<span class='line'>260</span>     @param {DOMElement} parentLayer the parent's DOM layer
<span class='line'>261</span>     @returns {DOMElement} the discovered layer
<span class='line'>262</span>   */</span><span class="WHIT">
<span class='line'>263</span> </span><span class="WHIT">  </span><span class="NAME">findLayerInParentLayer</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">parentLayer</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>264</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"#"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'layerId'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">escapeCssIdForSelector</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>265</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">jQuery</span><span class="PUNC">(</span><span class="NAME">id</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">parentLayer</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">jQuery</span><span class="PUNC">(</span><span class="NAME">id</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>266</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>267</span> 
<span class='line'>268</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>269</span>     Returns YES if the receiver is a subview of a given view or if it's
<span class='line'>270</span>     identical to that view. Otherwise, it returns NO.
<span class='line'>271</span> 
<span class='line'>272</span>     @property {SC.View} view
<span class='line'>273</span>   */</span><span class="WHIT">
<span class='line'>274</span> </span><span class="WHIT">  </span><span class="NAME">isDescendantOf</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>275</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parentView</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'parentView'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>276</span> 
<span class='line'>277</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">this</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">view</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>278</span> </span><span class="WHIT">    </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">parentView</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">parentView.isDescendantOf</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>279</span> </span><span class="WHIT">    </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>280</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>281</span> 
<span class='line'>282</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>283</span>     This method is invoked whenever a display property changes and updates
<span class='line'>284</span>     the view's content once at the end of the run loop before any invokeLast
<span class='line'>285</span>     functions run.
<span class='line'>286</span> 
<span class='line'>287</span>     To cause the view to be updated you can call this method directly and
<span class='line'>288</span>     if you need to perform additional setup whenever the display changes, you
<span class='line'>289</span>     can override this method as well.
<span class='line'>290</span> 
<span class='line'>291</span>     @returns {SC.View} receiver
<span class='line'>292</span>   */</span><span class="WHIT">
<span class='line'>293</span> </span><span class="WHIT">  </span><span class="NAME">displayDidChange</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>294</span> </span><span class="WHIT">    </span><span class="COMM">//@if (debug)</span><span class="WHIT">
<span class='line'>295</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.LOG_VIEW_STATES</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>296</span> </span><span class="WHIT">      </span><span class="NAME">SC.Logger.log</span><span class="PUNC">(</span><span class="STRN">'%c%@:%@ — displayDidChange()'</span><span class="PUNC">.</span><span class="NAME">fmt</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'viewState'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">SC.LOG_VIEW_STATES_STYLE</span><span class="PUNC">[</span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'viewState'</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>297</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>298</span> </span><span class="WHIT">    </span><span class="COMM">//@endif</span><span class="WHIT">
<span class='line'>299</span> 
<span class='line'>300</span> </span><span class="WHIT">    </span><span class="COMM">// Don't run _doUpdateContent needlessly, because the view may render</span><span class="WHIT">
<span class='line'>301</span> </span><span class="WHIT">    </span><span class="COMM">// before it is invoked, which would result in a needless update.</span><span class="WHIT">
<span class='line'>302</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'_isRendered'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>303</span> </span><span class="WHIT">      </span><span class="COMM">// Legacy.</span><span class="WHIT">
<span class='line'>304</span> </span><span class="WHIT">      </span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="STRN">'layerNeedsUpdate'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>305</span> 
<span class='line'>306</span> </span><span class="WHIT">      </span><span class="NAME">this.invokeOnce</span><span class="PUNC">(</span><span class="NAME">this._doUpdateContent</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>307</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>308</span> 
<span class='line'>309</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>310</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>311</span> 
<span class='line'>312</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>313</span>     This property has no effect and is deprecated.
<span class='line'>314</span> 
<span class='line'>315</span>     To cause a view to update immediately, you should just call updateLayer or
<span class='line'>316</span>     updateLayerIfNeeded.  To cause a view to update at the end of the run loop
<span class='line'>317</span>     before any invokeLast functions run, you should call displayDidChange.
<span class='line'>318</span> 
<span class='line'>319</span>     @deprecated Version 1.10
<span class='line'>320</span>     @type Boolean
<span class='line'>321</span>     @test in updateLayer
<span class='line'>322</span>   */</span><span class="WHIT">
<span class='line'>323</span> </span><span class="WHIT">  </span><span class="NAME">layerNeedsUpdate</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>324</span> 
<span class='line'>325</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>326</span>     Updates the view's layer if the view is in a shown state.  Otherwise, the
<span class='line'>327</span>     view will be updated the next time it enters a shown state.
<span class='line'>328</span> 
<span class='line'>329</span>     This is the same behavior as `displayDidChange` except that calling
<span class='line'>330</span>     `updateLayerIfNeeded` will attempt to update each time it is called,
<span class='line'>331</span>     while `displayDidChange` will only attempt to update the layer once per run
<span class='line'>332</span>     loop.
<span class='line'>333</span> 
<span class='line'>334</span>     @returns {SC.View} receiver
<span class='line'>335</span>     @test in updateLayer
<span class='line'>336</span>   */</span><span class="WHIT">
<span class='line'>337</span> </span><span class="WHIT">  </span><span class="NAME">updateLayerIfNeeded</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">skipIsVisibleInWindowCheck</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>338</span> </span><span class="WHIT">    </span><span class="COMM">//@if(debug)</span><span class="WHIT">
<span class='line'>339</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">skipIsVisibleInWindowCheck</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>340</span> </span><span class="WHIT">      </span><span class="NAME">SC.warn</span><span class="PUNC">(</span><span class="STRN">"Developer Warning: The `skipIsVisibleInWindowCheck` argument of updateLayerIfNeeded is not supported and will be ignored."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>341</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>342</span> </span><span class="WHIT">    </span><span class="COMM">//@endif</span><span class="WHIT">
<span class='line'>343</span> </span><span class="WHIT">    </span><span class="NAME">this._doUpdateContent</span><span class="PUNC">(</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>344</span> 
<span class='line'>345</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>346</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>347</span> 
<span class='line'>348</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>349</span>     This is the core method invoked to update a view layer whenever it has
<span class='line'>350</span>     changed.  This method simply creates a render context focused on the
<span class='line'>351</span>     layer element and then calls your render() method.
<span class='line'>352</span> 
<span class='line'>353</span>     You will not usually call or override this method directly.  Instead you
<span class='line'>354</span>     should set the layerNeedsUpdate property to YES to cause this method to
<span class='line'>355</span>     run at the end of the run loop, or you can call updateLayerIfNeeded()
<span class='line'>356</span>     to force the layer to update immediately.
<span class='line'>357</span> 
<span class='line'>358</span>     Instead of overriding this method, consider overriding the render() method
<span class='line'>359</span>     instead, which is called both when creating and updating a layer.  If you
<span class='line'>360</span>     do not want your render() method called when updating a layer, then you
<span class='line'>361</span>     should override this method instead.
<span class='line'>362</span> 
<span class='line'>363</span>     @returns {SC.View} receiver
<span class='line'>364</span>   */</span><span class="WHIT">
<span class='line'>365</span> </span><span class="WHIT">  </span><span class="NAME">updateLayer</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>366</span> </span><span class="WHIT">    </span><span class="NAME">this._doUpdateContent</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>367</span> 
<span class='line'>368</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>369</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>370</span> 
<span class='line'>371</span> </span><span class="WHIT">  </span><span class="COMM">/** @private */</span><span class="WHIT">
<span class='line'>372</span> </span><span class="WHIT">  </span><span class="NAME">parentViewDidResize</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>373</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'hasLayout'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this.notifyPropertyChange</span><span class="PUNC">(</span><span class="STRN">'frame'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>374</span> </span><span class="WHIT">    </span><span class="NAME">this.viewDidResize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>375</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>376</span> 
<span class='line'>377</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>378</span>     Override this in a child class to define behavior that should be invoked
<span class='line'>379</span>     when a parent's view was resized.
<span class='line'>380</span>    */</span><span class="WHIT">
<span class='line'>381</span> </span><span class="WHIT">  </span><span class="NAME">viewDidResize</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>382</span> 
<span class='line'>383</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>384</span>     Creates a new renderContext with the passed tagName or element.  You
<span class='line'>385</span>     can override this method to provide further customization to the context
<span class='line'>386</span>     if needed.  Normally you will not need to call or override this method.
<span class='line'>387</span> 
<span class='line'>388</span>     @returns {SC.RenderContext}
<span class='line'>389</span>   */</span><span class="WHIT">
<span class='line'>390</span> </span><span class="WHIT">  </span><span class="NAME">renderContext</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tagNameOrElement</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>391</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">SC.RenderContext</span><span class="PUNC">(</span><span class="NAME">tagNameOrElement</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>392</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>393</span> 
<span class='line'>394</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>395</span>     Creates the layer by creating a renderContext and invoking the view's
<span class='line'>396</span>     render() method.  This will only create the layer if the layer does not
<span class='line'>397</span>     already exist.
<span class='line'>398</span> 
<span class='line'>399</span>     When you create a layer, it is expected that your render() method will
<span class='line'>400</span>     also render the HTML for all child views as well.  This method will
<span class='line'>401</span>     notify the view along with any of its childViews that its layer has been
<span class='line'>402</span>     created.
<span class='line'>403</span> 
<span class='line'>404</span>     @returns {SC.View} receiver
<span class='line'>405</span>   */</span><span class="WHIT">
<span class='line'>406</span> </span><span class="WHIT">  </span><span class="NAME">createLayer</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>407</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'_isRendered'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>408</span> </span><span class="WHIT">      </span><span class="NAME">this._doRender</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>409</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>410</span> 
<span class='line'>411</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>412</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>413</span> 
<span class='line'>414</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>415</span>     Destroys any existing layer along with the layer for any child views as
<span class='line'>416</span>     well.  If the view does not currently have a layer, then this method will
<span class='line'>417</span>     do nothing.
<span class='line'>418</span> 
<span class='line'>419</span>     If you implement willDestroyLayer() on your view or if any mixins
<span class='line'>420</span>     implement willDestroLayerMixin(), then this method will be invoked on your
<span class='line'>421</span>     view before your layer is destroyed to give you a chance to clean up any
<span class='line'>422</span>     event handlers, etc.
<span class='line'>423</span> 
<span class='line'>424</span>     If you write a willDestroyLayer() handler, you can assume that your
<span class='line'>425</span>     didCreateLayer() handler was called earlier for the same layer.
<span class='line'>426</span> 
<span class='line'>427</span>     Normally you will not call or override this method yourself, but you may
<span class='line'>428</span>     want to implement the above callbacks when it is run.
<span class='line'>429</span> 
<span class='line'>430</span>     @returns {SC.View} receiver
<span class='line'>431</span>   */</span><span class="WHIT">
<span class='line'>432</span> </span><span class="WHIT">  </span><span class="NAME">destroyLayer</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>433</span> </span><span class="WHIT">    </span><span class="COMM">// We allow you to call destroy layer, but you should really detach first.</span><span class="WHIT">
<span class='line'>434</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'isAttached'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>435</span> </span><span class="WHIT">      </span><span class="NAME">this._doDetach</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>436</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>437</span> 
<span class='line'>438</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'_isRendered'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>439</span> </span><span class="WHIT">      </span><span class="NAME">this._doDestroyLayer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>440</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>441</span> 
<span class='line'>442</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>443</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>444</span> 
<span class='line'>445</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>446</span>     Destroys and recreates the current layer.  Doing this on a parent view can
<span class='line'>447</span>     be more efficient than modifying individual child views independently.
<span class='line'>448</span> 
<span class='line'>449</span>     @returns {SC.View} receiver
<span class='line'>450</span>   */</span><span class="WHIT">
<span class='line'>451</span> </span><span class="WHIT">  </span><span class="NAME">replaceLayer</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>452</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">layer</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">parentNode</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>453</span> 
<span class='line'>454</span> </span><span class="WHIT">    </span><span class="COMM">// If attached, detach and track our parent node so we can re-attach.</span><span class="WHIT">
<span class='line'>455</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'isAttached'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>456</span> </span><span class="WHIT">      </span><span class="NAME">layer</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'layer'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>457</span> </span><span class="WHIT">      </span><span class="NAME">parentNode</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">layer.parentNode</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>458</span> 
<span class='line'>459</span> </span><span class="WHIT">      </span><span class="NAME">this._doDetach</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>460</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>461</span> 
<span class='line'>462</span> </span><span class="WHIT">    </span><span class="NAME">this.destroyLayer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">createLayer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>463</span> 
<span class='line'>464</span> </span><span class="WHIT">    </span><span class="COMM">// Reattach our layer (if we have a parentView this is done automatically).</span><span class="WHIT">
<span class='line'>465</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">parentNode</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'isAttached'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this._doAttach</span><span class="PUNC">(</span><span class="NAME">parentNode</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>466</span> 
<span class='line'>467</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>468</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>469</span> 
<span class='line'>470</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>471</span>     If the parent view has changed, we need to insert this
<span class='line'>472</span>     view's layer into the layer of the new parent view.
<span class='line'>473</span>   */</span><span class="WHIT">
<span class='line'>474</span> </span><span class="WHIT">  </span><span class="NAME">parentViewDidChange</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>475</span> </span><span class="WHIT">    </span><span class="COMM">//@if(debug)</span><span class="WHIT">
<span class='line'>476</span> </span><span class="WHIT">    </span><span class="NAME">SC.warn</span><span class="PUNC">(</span><span class="STRN">"Developer Warning: parentViewDidChange has been deprecated.  Please use the notification methods willAddChild, didAddChild, willRemoveChild or didRemoveChild on the parent or willAddToParent, didAddToParent, willRemoveFromParent or didRemoveFromParent on the child to perform updates when the parent/child status changes."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>477</span> </span><span class="WHIT">    </span><span class="COMM">//@endif</span><span class="WHIT">
<span class='line'>478</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>479</span> 
<span class='line'>480</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>481</span>     Set to YES when the view's layer location is dirty.  You can call
<span class='line'>482</span>     updateLayerLocationIfNeeded() to clear this flag if it is set.
<span class='line'>483</span> 
<span class='line'>484</span>     @deprecated Version 1.10
<span class='line'>485</span>     @type Boolean
<span class='line'>486</span>   */</span><span class="WHIT">
<span class='line'>487</span> </span><span class="WHIT">  </span><span class="NAME">layerLocationNeedsUpdate</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>488</span> 
<span class='line'>489</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>490</span>     Calls updateLayerLocation(), but only if the view's layer location
<span class='line'>491</span>     currently needs to be updated.
<span class='line'>492</span> 
<span class='line'>493</span>     @deprecated Version 1.10
<span class='line'>494</span>     @returns {SC.View} receiver
<span class='line'>495</span>     @test in updateLayerLocation
<span class='line'>496</span>   */</span><span class="WHIT">
<span class='line'>497</span> </span><span class="WHIT">  </span><span class="NAME">updateLayerLocationIfNeeded</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>498</span> </span><span class="WHIT">    </span><span class="COMM">//@if(debug)</span><span class="WHIT">
<span class='line'>499</span> </span><span class="WHIT">    </span><span class="NAME">SC.warn</span><span class="PUNC">(</span><span class="STRN">"SC.View.prototype.updateLayerLocationIfNeeded is no longer used and has been deprecated.  See the SC.View statechart code for more details on attaching and detaching layers."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>500</span> </span><span class="WHIT">    </span><span class="COMM">//@endif</span><span class="WHIT">
<span class='line'>501</span> 
<span class='line'>502</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>503</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>504</span> 
<span class='line'>505</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>506</span>     This method is called when a view changes its location in the view
<span class='line'>507</span>     hierarchy.  This method will update the underlying DOM-location of the
<span class='line'>508</span>     layer so that it reflects the new location.
<span class='line'>509</span> 
<span class='line'>510</span>     @deprecated Version 1.10
<span class='line'>511</span>     @returns {SC.View} receiver
<span class='line'>512</span>   */</span><span class="WHIT">
<span class='line'>513</span> </span><span class="WHIT">  </span><span class="NAME">updateLayerLocation</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>514</span> </span><span class="WHIT">    </span><span class="COMM">//@if(debug)</span><span class="WHIT">
<span class='line'>515</span> </span><span class="WHIT">    </span><span class="NAME">SC.warn</span><span class="PUNC">(</span><span class="STRN">"SC.View.prototype.updateLayerLocation is no longer used and has been deprecated.  See the SC.View statechart code for more details on attaching and detaching layers."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>516</span> </span><span class="WHIT">    </span><span class="COMM">//@endif</span><span class="WHIT">
<span class='line'>517</span> 
<span class='line'>518</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>519</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>520</span> 
<span class='line'>521</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>522</span>     @private
<span class='line'>523</span> 
<span class='line'>524</span>     Renders to a context.
<span class='line'>525</span>     Rendering only happens for the initial rendering. Further updates happen in updateLayer,
<span class='line'>526</span>     and are not done to contexts, but to layers.
<span class='line'>527</span>     Note: You should not generally override nor directly call this method. This method is only
<span class='line'>528</span>     called by createLayer to set up the layer initially, and by renderChildViews, to write to
<span class='line'>529</span>     a context.
<span class='line'>530</span> 
<span class='line'>531</span>     @param {SC.RenderContext} context the render context.
<span class='line'>532</span>   */</span><span class="WHIT">
<span class='line'>533</span> </span><span class="WHIT">  </span><span class="NAME">renderToContext</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">context</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>534</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">mixins</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>535</span> 
<span class='line'>536</span> </span><span class="WHIT">    </span><span class="NAME">this.beginPropertyChanges</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>537</span> 
<span class='line'>538</span> </span><span class="WHIT">    </span><span class="NAME">context.id</span><span class="PUNC">(</span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'layerId'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>539</span> </span><span class="WHIT">    </span><span class="NAME">context.setAttr</span><span class="PUNC">(</span><span class="STRN">'role'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'ariaRole'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>540</span> 
<span class='line'>541</span> </span><span class="WHIT">    </span><span class="COMM">// Set up the classNameBindings and attributeBindings observers.</span><span class="WHIT">
<span class='line'>542</span> </span><span class="WHIT">    </span><span class="COMM">// TODO: CLEAN UP!!</span><span class="WHIT">
<span class='line'>543</span> </span><span class="WHIT">    </span><span class="NAME">this._applyClassNameBindings</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>544</span> </span><span class="WHIT">    </span><span class="NAME">this._applyAttributeBindings</span><span class="PUNC">(</span><span class="NAME">context</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>545</span> 
<span class='line'>546</span> </span><span class="WHIT">    </span><span class="NAME">context.addClass</span><span class="PUNC">(</span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'classNames'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>547</span> 
<span class='line'>548</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'isTextSelectable'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">context.addClass</span><span class="PUNC">(</span><span class="STRN">'allow-select'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>549</span> 
<span class='line'>550</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'isVisible'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>551</span> </span><span class="WHIT">      </span><span class="NAME">context.addClass</span><span class="PUNC">(</span><span class="STRN">'sc-hidden'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>552</span> </span><span class="WHIT">      </span><span class="NAME">context.setAttr</span><span class="PUNC">(</span><span class="STRN">'aria-hidden'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'true'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>553</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>554</span> 
<span class='line'>555</span> </span><span class="WHIT">    </span><span class="COMM">// Call applyAttributesToContext so that subclasses that override it can</span><span class="WHIT">
<span class='line'>556</span> </span><span class="WHIT">    </span><span class="COMM">// insert further attributes.</span><span class="WHIT">
<span class='line'>557</span> </span><span class="WHIT">    </span><span class="NAME">this.applyAttributesToContext</span><span class="PUNC">(</span><span class="NAME">context</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>558</span> 
<span class='line'>559</span> </span><span class="WHIT">    </span><span class="COMM">// We pass true for the second argument to support the old style of render.</span><span class="WHIT">
<span class='line'>560</span> </span><span class="WHIT">    </span><span class="NAME">this.render</span><span class="PUNC">(</span><span class="NAME">context</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>561</span> 
<span class='line'>562</span> </span><span class="WHIT">    </span><span class="COMM">// If we've made it this far and renderChildViews() was never called,</span><span class="WHIT">
<span class='line'>563</span> </span><span class="WHIT">    </span><span class="COMM">// render any child views now.</span><span class="WHIT">
<span class='line'>564</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this._didRenderChildViews</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this.renderChildViews</span><span class="PUNC">(</span><span class="NAME">context</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>565</span> </span><span class="WHIT">    </span><span class="COMM">// Reset the flag so that if the layer is recreated we re-render the child views.</span><span class="WHIT">
<span class='line'>566</span> </span><span class="WHIT">    </span><span class="NAME">this._didRenderChildViews</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>567</span> 
<span class='line'>568</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">mixins</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.renderMixin</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>569</span> </span><span class="WHIT">      </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">mixins.length</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>570</span> </span><span class="WHIT">      </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">++</span><span class="NAME">idx</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">mixins</span><span class="PUNC">[</span><span class="NAME">idx</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">context</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>571</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>572</span> 
<span class='line'>573</span> </span><span class="WHIT">    </span><span class="NAME">this.endPropertyChanges</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>574</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>575</span> 
<span class='line'>576</span> </span><span class="WHIT">  </span><span class="COMM">/** Apply the attributes to the context. */</span><span class="WHIT">
<span class='line'>577</span> </span><span class="WHIT">  </span><span class="NAME">applyAttributesToContext</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">context</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>578</span> 
<span class='line'>579</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>580</span> 
<span class='line'>581</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>582</span>     @private
<span class='line'>583</span> 
<span class='line'>584</span>     Iterates over the view's `classNameBindings` array, inserts the value
<span class='line'>585</span>     of the specified property into the `classNames` array, then creates an
<span class='line'>586</span>     observer to update the view's element if the bound property ever changes
<span class='line'>587</span>     in the future.
<span class='line'>588</span>   */</span><span class="WHIT">
<span class='line'>589</span> </span><span class="WHIT">  </span><span class="NAME">_applyClassNameBindings</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>590</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">classBindings</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'classNameBindings'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>591</span> </span><span class="WHIT">        </span><span class="NAME">classNames</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'classNames'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>592</span> </span><span class="WHIT">        </span><span class="NAME">dasherizedClass</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>593</span> 
<span class='line'>594</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">classBindings</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>595</span> 
<span class='line'>596</span> </span><span class="WHIT">    </span><span class="COMM">// Loop through all of the configured bindings. These will be either</span><span class="WHIT">
<span class='line'>597</span> </span><span class="WHIT">    </span><span class="COMM">// property names ('isUrgent') or property paths relative to the view</span><span class="WHIT">
<span class='line'>598</span> </span><span class="WHIT">    </span><span class="COMM">// ('content.isUrgent')</span><span class="WHIT">
<span class='line'>599</span> </span><span class="WHIT">    </span><span class="NAME">classBindings.forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">property</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>600</span> 
<span class='line'>601</span> </span><span class="WHIT">      </span><span class="COMM">// Variable in which the old class value is saved. The observer function</span><span class="WHIT">
<span class='line'>602</span> </span><span class="WHIT">      </span><span class="COMM">// closes over this variable, so it knows which string to remove when</span><span class="WHIT">
<span class='line'>603</span> </span><span class="WHIT">      </span><span class="COMM">// the property changes.</span><span class="WHIT">
<span class='line'>604</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">oldClass</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>605</span> 
<span class='line'>606</span> </span><span class="WHIT">      </span><span class="COMM">// Set up an observer on the context. If the property changes, toggle the</span><span class="WHIT">
<span class='line'>607</span> </span><span class="WHIT">      </span><span class="COMM">// class name.</span><span class="WHIT">
<span class='line'>608</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">observer</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>609</span> </span><span class="WHIT">        </span><span class="COMM">// Get the current value of the property</span><span class="WHIT">
<span class='line'>610</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">newClass</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._classStringForProperty</span><span class="PUNC">(</span><span class="NAME">property</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>611</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">elem</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.$</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>612</span> 
<span class='line'>613</span> </span><span class="WHIT">        </span><span class="COMM">// If we had previously added a class to the element, remove it.</span><span class="WHIT">
<span class='line'>614</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">oldClass</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>615</span> </span><span class="WHIT">          </span><span class="NAME">elem.removeClass</span><span class="PUNC">(</span><span class="NAME">oldClass</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>616</span> </span><span class="WHIT">          </span><span class="NAME">classNames.removeObject</span><span class="PUNC">(</span><span class="NAME">oldClass</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>617</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>618</span> 
<span class='line'>619</span> </span><span class="WHIT">        </span><span class="COMM">// If necessary, add a new class. Make sure we keep track of it so</span><span class="WHIT">
<span class='line'>620</span> </span><span class="WHIT">        </span><span class="COMM">// it can be removed in the future.</span><span class="WHIT">
<span class='line'>621</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">newClass</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>622</span> </span><span class="WHIT">          </span><span class="NAME">elem.addClass</span><span class="PUNC">(</span><span class="NAME">newClass</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>623</span> </span><span class="WHIT">          </span><span class="NAME">classNames.push</span><span class="PUNC">(</span><span class="NAME">newClass</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>624</span> </span><span class="WHIT">          </span><span class="NAME">oldClass</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">newClass</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>625</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>626</span> </span><span class="WHIT">          </span><span class="NAME">oldClass</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>627</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>628</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>629</span> 
<span class='line'>630</span> </span><span class="WHIT">      </span><span class="NAME">this.addObserver</span><span class="PUNC">(</span><span class="NAME">property.split</span><span class="PUNC">(</span><span class="STRN">':'</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">observer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>631</span> 
<span class='line'>632</span> </span><span class="WHIT">      </span><span class="COMM">// Get the class name for the property at its current value</span><span class="WHIT">
<span class='line'>633</span> </span><span class="WHIT">      </span><span class="NAME">dasherizedClass</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._classStringForProperty</span><span class="PUNC">(</span><span class="NAME">property</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>634</span> 
<span class='line'>635</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">dasherizedClass</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>636</span> </span><span class="WHIT">        </span><span class="COMM">// Ensure that it gets into the classNames array</span><span class="WHIT">
<span class='line'>637</span> </span><span class="WHIT">        </span><span class="COMM">// so it is displayed when we render.</span><span class="WHIT">
<span class='line'>638</span> </span><span class="WHIT">        </span><span class="NAME">classNames.push</span><span class="PUNC">(</span><span class="NAME">dasherizedClass</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>639</span> 
<span class='line'>640</span> </span><span class="WHIT">        </span><span class="COMM">// Save a reference to the class name so we can remove it</span><span class="WHIT">
<span class='line'>641</span> </span><span class="WHIT">        </span><span class="COMM">// if the observer fires. Remember that this variable has</span><span class="WHIT">
<span class='line'>642</span> </span><span class="WHIT">        </span><span class="COMM">// been closed over by the observer.</span><span class="WHIT">
<span class='line'>643</span> </span><span class="WHIT">        </span><span class="NAME">oldClass</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">dasherizedClass</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>644</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>645</span> 
<span class='line'>646</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>647</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>648</span> 
<span class='line'>649</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>650</span>     Iterates through the view's attribute bindings, sets up observers for each,
<span class='line'>651</span>     then applies the current value of the attributes to the passed render buffer.
<span class='line'>652</span> 
<span class='line'>653</span>     @param {SC.RenderBuffer} buffer
<span class='line'>654</span>   */</span><span class="WHIT">
<span class='line'>655</span> </span><span class="WHIT">  </span><span class="NAME">_applyAttributeBindings</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">context</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>656</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">attributeBindings</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'attributeBindings'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>657</span> </span><span class="WHIT">        </span><span class="NAME">attributeValue</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">elem</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">type</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>658</span> 
<span class='line'>659</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">attributeBindings</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>660</span> 
<span class='line'>661</span> </span><span class="WHIT">    </span><span class="NAME">attributeBindings.forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">attribute</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>662</span> </span><span class="WHIT">      </span><span class="COMM">// Create an observer to add/remove/change the attribute if the</span><span class="WHIT">
<span class='line'>663</span> </span><span class="WHIT">      </span><span class="COMM">// JavaScript property changes.</span><span class="WHIT">
<span class='line'>664</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">observer</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>665</span> </span><span class="WHIT">        </span><span class="NAME">elem</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.$</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>666</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">currentValue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">elem.attr</span><span class="PUNC">(</span><span class="NAME">attribute</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>667</span> </span><span class="WHIT">        </span><span class="NAME">attributeValue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="NAME">attribute</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>668</span> 
<span class='line'>669</span> </span><span class="WHIT">        </span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">attributeValue</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>670</span> 
<span class='line'>671</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'string'</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'number'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">attributeValue</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">currentValue</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>672</span> </span><span class="WHIT">          </span><span class="NAME">elem.attr</span><span class="PUNC">(</span><span class="NAME">attribute</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">attributeValue</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>673</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">attributeValue</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'boolean'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>674</span> </span><span class="WHIT">          </span><span class="NAME">elem.attr</span><span class="PUNC">(</span><span class="NAME">attribute</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">attribute</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>675</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">attributeValue</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>676</span> </span><span class="WHIT">          </span><span class="NAME">elem.removeAttr</span><span class="PUNC">(</span><span class="NAME">attribute</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>677</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>678</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>679</span> 
<span class='line'>680</span> </span><span class="WHIT">      </span><span class="NAME">this.addObserver</span><span class="PUNC">(</span><span class="NAME">attribute</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">observer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>681</span> 
<span class='line'>682</span> </span><span class="WHIT">      </span><span class="COMM">// Determine the current value and add it to the render buffer</span><span class="WHIT">
<span class='line'>683</span> </span><span class="WHIT">      </span><span class="COMM">// if necessary.</span><span class="WHIT">
<span class='line'>684</span> </span><span class="WHIT">      </span><span class="NAME">attributeValue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="NAME">attribute</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>685</span> </span><span class="WHIT">      </span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">attributeValue</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>686</span> 
<span class='line'>687</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'string'</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'number'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>688</span> </span><span class="WHIT">        </span><span class="NAME">context.setAttr</span><span class="PUNC">(</span><span class="NAME">attribute</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">attributeValue</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>689</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">attributeValue</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'boolean'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>690</span> </span><span class="WHIT">        </span><span class="COMM">// Apply boolean attributes in the form attribute="attribute"</span><span class="WHIT">
<span class='line'>691</span> </span><span class="WHIT">        </span><span class="NAME">context.setAttr</span><span class="PUNC">(</span><span class="NAME">attribute</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">attribute</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>692</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>693</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>694</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>695</span> 
<span class='line'>696</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>697</span>     @private
<span class='line'>698</span> 
<span class='line'>699</span>     Given a property name, returns a dasherized version of that
<span class='line'>700</span>     property name if the property evaluates to a non-falsy value.
<span class='line'>701</span> 
<span class='line'>702</span>     For example, if the view has property `isUrgent` that evaluates to true,
<span class='line'>703</span>     passing `isUrgent` to this method will return `"is-urgent"`.
<span class='line'>704</span>   */</span><span class="WHIT">
<span class='line'>705</span> </span><span class="WHIT">  </span><span class="NAME">_classStringForProperty</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">property</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>706</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">split</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">property.split</span><span class="PUNC">(</span><span class="STRN">':'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">className</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">split</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>707</span> </span><span class="WHIT">    </span><span class="NAME">property</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">split</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>708</span> 
<span class='line'>709</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">val</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.getPath</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">property</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>710</span> 
<span class='line'>711</span> </span><span class="WHIT">    </span><span class="COMM">// If value is a Boolean and true, return the dasherized property</span><span class="WHIT">
<span class='line'>712</span> </span><span class="WHIT">    </span><span class="COMM">// name.</span><span class="WHIT">
<span class='line'>713</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">val</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>714</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">className</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">className</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>715</span> 
<span class='line'>716</span> </span><span class="WHIT">      </span><span class="COMM">// Normalize property path to be suitable for use</span><span class="WHIT">
<span class='line'>717</span> </span><span class="WHIT">      </span><span class="COMM">// as a class name. For exaple, content.foo.barBaz</span><span class="WHIT">
<span class='line'>718</span> </span><span class="WHIT">      </span><span class="COMM">// becomes bar-baz.</span><span class="WHIT">
<span class='line'>719</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">SC.String.dasherize</span><span class="PUNC">(</span><span class="NAME">property.split</span><span class="PUNC">(</span><span class="STRN">'.'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">get</span><span class="PUNC">(</span><span class="STRN">'lastObject'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>720</span> 
<span class='line'>721</span> </span><span class="WHIT">    </span><span class="COMM">// If the value is not NO, undefined, or null, return the current</span><span class="WHIT">
<span class='line'>722</span> </span><span class="WHIT">    </span><span class="COMM">// value of the property.</span><span class="WHIT">
<span class='line'>723</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">val</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">val</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">val</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>724</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">val</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>725</span> 
<span class='line'>726</span> </span><span class="WHIT">    </span><span class="COMM">// Nothing to display. Return null so that the old class is removed</span><span class="WHIT">
<span class='line'>727</span> </span><span class="WHIT">    </span><span class="COMM">// but no new class is added.</span><span class="WHIT">
<span class='line'>728</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>729</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>730</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>731</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>732</span> 
<span class='line'>733</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>734</span>     Your render method should invoke this method to render any child views,
<span class='line'>735</span>     especially if this is the first time the view will be rendered.  This will
<span class='line'>736</span>     walk down the childView chain, rendering all of the children in a nested
<span class='line'>737</span>     way.
<span class='line'>738</span> 
<span class='line'>739</span>     @param {SC.RenderContext} context the context
<span class='line'>740</span>     @returns {SC.RenderContext} the render context
<span class='line'>741</span>     @test in render
<span class='line'>742</span>   */</span><span class="WHIT">
<span class='line'>743</span> </span><span class="WHIT">  </span><span class="NAME">renderChildViews</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">context</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>744</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">cv</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'childViews'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">cv.length</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">view</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>745</span> </span><span class="WHIT">    </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">++</span><span class="NAME">idx</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>746</span> </span><span class="WHIT">      </span><span class="NAME">view</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">cv</span><span class="PUNC">[</span><span class="NAME">idx</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>747</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">view</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>748</span> </span><span class="WHIT">      </span><span class="NAME">context</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">context.begin</span><span class="PUNC">(</span><span class="NAME">view.get</span><span class="PUNC">(</span><span class="STRN">'tagName'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>749</span> </span><span class="WHIT">      </span><span class="NAME">view.renderToContext</span><span class="PUNC">(</span><span class="NAME">context</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>750</span> </span><span class="WHIT">      </span><span class="NAME">context</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">context.end</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>751</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>752</span> 
<span class='line'>753</span> </span><span class="WHIT">    </span><span class="COMM">// Track that renderChildViews was called in case it was called directly</span><span class="WHIT">
<span class='line'>754</span> </span><span class="WHIT">    </span><span class="COMM">// in a render method.</span><span class="WHIT">
<span class='line'>755</span> </span><span class="WHIT">    </span><span class="NAME">this._didRenderChildViews</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>756</span> 
<span class='line'>757</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">context</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>758</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>759</span> 
<span class='line'>760</span> </span><span class="WHIT">  </span><span class="COMM">/** @private -
<span class='line'>761</span>     override to add support for theming or in your view
<span class='line'>762</span>   */</span><span class="WHIT">
<span class='line'>763</span> </span><span class="WHIT">  </span><span class="NAME">render</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>764</span> 
<span class='line'>765</span> </span><span class="WHIT">  </span><span class="COMM">// ..........................................................</span><span class="WHIT">
<span class='line'>766</span> </span><span class="WHIT">  </span><span class="COMM">// STANDARD RENDER PROPERTIES</span><span class="WHIT">
<span class='line'>767</span> </span><span class="WHIT">  </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>768</span> 
<span class='line'>769</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>770</span>     A list of properties on the view to translate dynamically into attributes on
<span class='line'>771</span>     the view's layer (element).
<span class='line'>772</span> 
<span class='line'>773</span>     When the view is rendered, the value of each property listed in
<span class='line'>774</span>     attributeBindings will be inserted in the element.  If the value is a
<span class='line'>775</span>     Boolean, the attribute name itself will be inserted.  As well, as the
<span class='line'>776</span>     value of any of these properties changes, the layer will update itself
<span class='line'>777</span>     automatically.
<span class='line'>778</span> 
<span class='line'>779</span>     This is an easy way to set custom attributes on the View without
<span class='line'>780</span>     implementing it through a render or update function.
<span class='line'>781</span> 
<span class='line'>782</span>     For example,
<span class='line'>783</span> 
<span class='line'>784</span>         // ...  MyApp.MyView
<span class='line'>785</span> 
<span class='line'>786</span>         attributeBindings: ['aria-valuenow', 'disabled'],
<span class='line'>787</span> 
<span class='line'>788</span>         'aria-valuenow': function () {
<span class='line'>789</span>           return this.get('value');
<span class='line'>790</span>         }.property('value').cacheable(), // adds 'aria-valuenow="{value}"' attribute
<span class='line'>791</span> 
<span class='line'>792</span>         disabled: YES, // adds 'disabled="disabled"' attribute
<span class='line'>793</span> 
<span class='line'>794</span>         // ...
<span class='line'>795</span> 
<span class='line'>796</span>     @type Array
<span class='line'>797</span>     @default null
<span class='line'>798</span>   */</span><span class="WHIT">
<span class='line'>799</span> </span><span class="WHIT">  </span><span class="NAME">attributeBindings</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>800</span> 
<span class='line'>801</span> 
<span class='line'>802</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>803</span>     Tag name for the view's outer element.  The tag name is only used when
<span class='line'>804</span>     a layer is first created.  If you change the tagName for an element, you
<span class='line'>805</span>     must destroy and recreate the view layer.
<span class='line'>806</span> 
<span class='line'>807</span>     @type String
<span class='line'>808</span>     @default 'div'
<span class='line'>809</span>   */</span><span class="WHIT">
<span class='line'>810</span> </span><span class="WHIT">  </span><span class="NAME">tagName</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'div'</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>811</span> 
<span class='line'>812</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>813</span>     Standard CSS class names to apply to the view's outer element.  These class
<span class='line'>814</span>     names are used in addition to any defined on the view's superclass.
<span class='line'>815</span> 
<span class='line'>816</span>     @type Array
<span class='line'>817</span>     @default []
<span class='line'>818</span>   */</span><span class="WHIT">
<span class='line'>819</span> </span><span class="WHIT">  </span><span class="NAME">classNames</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>820</span> 
<span class='line'>821</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>822</span>     A list of local property names to translate dynamically into standard
<span class='line'>823</span>     CSS class names on your view's layer (element).
<span class='line'>824</span> 
<span class='line'>825</span>     Each entry in the array should take the form "propertyName:css-class".
<span class='line'>826</span>     For example, "isRed:my-red-view" will cause the class "my-red-view" to
<span class='line'>827</span>     be appended if the property "isRed" is (or becomes) true, and removed
<span class='line'>828</span>     if it later becomes false (or null/undefined).
<span class='line'>829</span> 
<span class='line'>830</span>     Optionally, you may provide just the property name, in which case it will
<span class='line'>831</span>     be dasherized and used as the class name.  For example, including
<span class='line'>832</span>     "isUpsideDown" will cause the view's isUpsideDown property to mediate the
<span class='line'>833</span>     class "is-upside-down".
<span class='line'>834</span> 
<span class='line'>835</span>     Instead of a boolean value, your property may return a string, which will
<span class='line'>836</span>     be used as the class name for that entry.  Use caution when returning other
<span class='line'>837</span>     values; numbers will be appended verbatim and objects will be stringified,
<span class='line'>838</span>     leading to unintended results such as class="4" or class="Object object".
<span class='line'>839</span> 
<span class='line'>840</span>     Class names mediated by these bindings are used in addition to any that
<span class='line'>841</span>     you've listed in the classNames property.
<span class='line'>842</span> 
<span class='line'>843</span>     @type Array
<span class='line'>844</span>   */</span><span class="WHIT">
<span class='line'>845</span> </span><span class="WHIT">  </span><span class="NAME">classNameBindings</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>846</span> 
<span class='line'>847</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>848</span>     Tool tip property that will be set to the title attribute on the HTML
<span class='line'>849</span>     rendered element.
<span class='line'>850</span> 
<span class='line'>851</span>     @type String
<span class='line'>852</span>   */</span><span class="WHIT">
<span class='line'>853</span> </span><span class="WHIT">  </span><span class="NAME">toolTip</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>854</span> 
<span class='line'>855</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>856</span>     The computed tooltip.  This is generated by localizing the toolTip
<span class='line'>857</span>     property if necessary.
<span class='line'>858</span> 
<span class='line'>859</span>     @type String
<span class='line'>860</span>   */</span><span class="WHIT">
<span class='line'>861</span> </span><span class="WHIT">  </span><span class="NAME">displayToolTip</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>862</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'toolTip'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>863</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'localize'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">SC.String.loc</span><span class="PUNC">(</span><span class="NAME">ret</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>864</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">.</span><span class="NAME">property</span><span class="PUNC">(</span><span class="STRN">'toolTip'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'localize'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">cacheable</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>865</span> 
<span class='line'>866</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>867</span>     Determines if the user can select text within the view.  Normally this is
<span class='line'>868</span>     set to NO to disable text selection.  You should set this to YES if you
<span class='line'>869</span>     are creating a view that includes editable text.  Otherwise, settings this
<span class='line'>870</span>     to YES will probably make your controls harder to use and it is not
<span class='line'>871</span>     recommended.
<span class='line'>872</span> 
<span class='line'>873</span>     @type Boolean
<span class='line'>874</span>     @readOnly
<span class='line'>875</span>   */</span><span class="WHIT">
<span class='line'>876</span> </span><span class="WHIT">  </span><span class="NAME">isTextSelectable</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>877</span> 
<span class='line'>878</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>879</span>     You can set this array to include any properties that should immediately
<span class='line'>880</span>     invalidate the display.  The display will be automatically invalidated
<span class='line'>881</span>     when one of these properties change.
<span class='line'>882</span> 
<span class='line'>883</span>     These are the properties that will be visible to any Render Delegate.
<span class='line'>884</span>     When the RenderDelegate asks for a property it needs, the view checks the
<span class='line'>885</span>     displayProperties array. It first looks for the property name prefixed
<span class='line'>886</span>     by 'display'; for instance, if the render delegate needs a 'title',
<span class='line'>887</span>     the view will attempt to find 'displayTitle'. If there is no 'displayTitle'
<span class='line'>888</span>     in displayProperties, the view will then try 'title'. If 'title' is not
<span class='line'>889</span>     in displayProperties either, an error will be thrown.
<span class='line'>890</span> 
<span class='line'>891</span>     This allows you to avoid collisions between your view's API and the Render
<span class='line'>892</span>     Delegate's API.
<span class='line'>893</span> 
<span class='line'>894</span>     Implementation note:  'isVisible' is also effectively a display property,
<span class='line'>895</span>     but it is not declared as such because it is observed separately in
<span class='line'>896</span>     order to manage the view's internal state.
<span class='line'>897</span> 
<span class='line'>898</span>     @type Array
<span class='line'>899</span>     @readOnly
<span class='line'>900</span>   */</span><span class="WHIT">
<span class='line'>901</span> </span><span class="WHIT">  </span><span class="NAME">displayProperties</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>902</span> 
<span class='line'>903</span> </span><span class="WHIT">  </span><span class="COMM">// .......................................................</span><span class="WHIT">
<span class='line'>904</span> </span><span class="WHIT">  </span><span class="COMM">// SC.RESPONDER SUPPORT</span><span class="WHIT">
<span class='line'>905</span> </span><span class="WHIT">  </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>906</span> 
<span class='line'>907</span> </span><span class="WHIT">  </span><span class="COMM">/** @property
<span class='line'>908</span>     The nextResponder is usually the parentView.
<span class='line'>909</span>   */</span><span class="WHIT">
<span class='line'>910</span> </span><span class="WHIT">  </span><span class="NAME">nextResponder</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>911</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'parentView'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>912</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">.</span><span class="NAME">property</span><span class="PUNC">(</span><span class="STRN">'parentView'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">cacheable</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>913</span> 
<span class='line'>914</span> 
<span class='line'>915</span> </span><span class="WHIT">  </span><span class="COMM">/** @property
<span class='line'>916</span>     Set to YES if your view is willing to accept first responder status.  This
<span class='line'>917</span>     is used when calculating key responder loop.
<span class='line'>918</span>   */</span><span class="WHIT">
<span class='line'>919</span> </span><span class="WHIT">  </span><span class="NAME">acceptsFirstResponder</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">NO</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>920</span> 
<span class='line'>921</span> </span><span class="WHIT">  </span><span class="COMM">// .......................................................</span><span class="WHIT">
<span class='line'>922</span> </span><span class="WHIT">  </span><span class="COMM">// CORE DISPLAY METHODS</span><span class="WHIT">
<span class='line'>923</span> </span><span class="WHIT">  </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>924</span> 
<span class='line'>925</span> </span><span class="WHIT">  </span><span class="COMM">/** @private
<span class='line'>926</span>     Caches the layerId to detect when it changes.
<span class='line'>927</span>     */</span><span class="WHIT">
<span class='line'>928</span> </span><span class="WHIT">  </span><span class="NAME">_lastLayerId</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>929</span> 
<span class='line'>930</span> </span><span class="WHIT">  </span><span class="COMM">/** @private
<span class='line'>931</span>     Setup a view, but do not finish waking it up.
<span class='line'>932</span> 
<span class='line'>933</span>      - configure childViews
<span class='line'>934</span>      - Determine the view's theme
<span class='line'>935</span>      - Fetch a render delegate from the theme, if necessary
<span class='line'>936</span>      - register the view with the global views hash, which is used for event
<span class='line'>937</span>        dispatch
<span class='line'>938</span>   */</span><span class="WHIT">
<span class='line'>939</span> </span><span class="WHIT">  </span><span class="NAME">init</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>940</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">childViews</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">layerId</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>941</span> 
<span class='line'>942</span> </span><span class="WHIT">    </span><span class="NAME">sc_super</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>943</span> 
<span class='line'>944</span> </span><span class="WHIT">    </span><span class="NAME">layerId</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._lastLayerId</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'layerId'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>945</span> 
<span class='line'>946</span> </span><span class="WHIT">    </span><span class="COMM">// Register the view for event handling. This hash is used by</span><span class="WHIT">
<span class='line'>947</span> </span><span class="WHIT">    </span><span class="COMM">// SC.RootResponder to dispatch incoming events.</span><span class="WHIT">
<span class='line'>948</span> </span><span class="WHIT">    </span><span class="COMM">//@if (debug)</span><span class="WHIT">
<span class='line'>949</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.View.views</span><span class="PUNC">[</span><span class="NAME">layerId</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>950</span> </span><span class="WHIT">      </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">"Developer Error: A view with layerId, '%@', already exists.  Each view must have a unique layerId."</span><span class="PUNC">.</span><span class="NAME">fmt</span><span class="PUNC">(</span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'layerId'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>951</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>952</span> </span><span class="WHIT">    </span><span class="COMM">//@endif</span><span class="WHIT">
<span class='line'>953</span> </span><span class="WHIT">    </span><span class="NAME">SC.View.views</span><span class="PUNC">[</span><span class="NAME">layerId</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>954</span> 
<span class='line'>955</span> </span><span class="WHIT">    </span><span class="COMM">// setup classNames</span><span class="WHIT">
<span class='line'>956</span> </span><span class="WHIT">    </span><span class="NAME">this.classNames</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'classNames'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">slice</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>957</span> 
<span class='line'>958</span> </span><span class="WHIT">    </span><span class="COMM">// setup child views.  be sure to clone the child views array first</span><span class="WHIT">
<span class='line'>959</span> </span><span class="WHIT">    </span><span class="NAME">childViews</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.childViews</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'childViews'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">slice</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>960</span> </span><span class="WHIT">    </span><span class="NAME">this.createChildViews</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// setup child Views</span><span class="WHIT">
<span class='line'>961</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>962</span> 
<span class='line'>963</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>964</span>     Frame describes this view's current bounding rect, relative to its parent view. You
<span class='line'>965</span>     can use this, for example, to reliably access a width for a view whose layout is
<span class='line'>966</span>     defined with left and right. (Note that width and height values are calculated in
<span class='line'>967</span>     the parent view's frame of reference as well, which has consequences for scaled
<span class='line'>968</span>     views.)
<span class='line'>969</span> 
<span class='line'>970</span>     @type Rect
<span class='line'>971</span>     @test in layoutStyle
<span class='line'>972</span>   */</span><span class="WHIT">
<span class='line'>973</span> </span><span class="WHIT">  </span><span class="NAME">frame</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>974</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.computeFrameWithParentFrame</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>975</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">.</span><span class="NAME">property</span><span class="PUNC">(</span><span class="STRN">'useStaticLayout'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">cacheable</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">    </span><span class="COMM">// We depend on the layout, but layoutDidChange will call viewDidResize to check the frame for us</span><span class="WHIT">
<span class='line'>976</span> 
<span class='line'>977</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>978</span>     Computes the frame of the view by examining the view's DOM representation.
<span class='line'>979</span>     If no representation exists, returns null.
<span class='line'>980</span> 
<span class='line'>981</span>     If the view has a parent view, the parent's bounds will be taken into account when
<span class='line'>982</span>     calculating the frame.
<span class='line'>983</span> 
<span class='line'>984</span>     @returns {Rect} the computed frame
<span class='line'>985</span>   */</span><span class="WHIT">
<span class='line'>986</span> </span><span class="WHIT">  </span><span class="NAME">computeFrameWithParentFrame</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>987</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">layer</span><span class="PUNC">,</span><span class="WHIT">                            </span><span class="COMM">// The view's layer</span><span class="WHIT">
<span class='line'>988</span> </span><span class="WHIT">        </span><span class="NAME">pv</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'parentView'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">      </span><span class="COMM">// The view's parent view (if it exists)</span><span class="WHIT">
<span class='line'>989</span> </span><span class="WHIT">        </span><span class="NAME">f</span><span class="PUNC">;</span><span class="WHIT">                                </span><span class="COMM">// The layer's coordinates in the document</span><span class="WHIT">
<span class='line'>990</span> 
<span class='line'>991</span> </span><span class="WHIT">    </span><span class="COMM">// need layer to be able to compute rect</span><span class="WHIT">
<span class='line'>992</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">layer</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'layer'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>993</span> </span><span class="WHIT">      </span><span class="NAME">f</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.offset</span><span class="PUNC">(</span><span class="NAME">layer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// x,y</span><span class="WHIT">
<span class='line'>994</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">pv</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">f</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">pv.convertFrameFromView</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>995</span> 
<span class='line'>996</span> </span><span class="WHIT">      </span><span class="COMM">/*
<span class='line'>997</span>         TODO Can probably have some better width/height values - CC
<span class='line'>998</span>         FIXME This will probably not work right with borders - PW
<span class='line'>999</span>       */</span><span class="WHIT">
<span class='line'>1000</span> </span><span class="WHIT">      </span><span class="NAME">f.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">layer.offsetWidth</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1001</span> </span><span class="WHIT">      </span><span class="NAME">f.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">layer.offsetHeight</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1002</span> 
<span class='line'>1003</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1004</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1005</span> 
<span class='line'>1006</span> </span><span class="WHIT">    </span><span class="COMM">// Unable to compute yet</span><span class="WHIT">
<span class='line'>1007</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'hasLayout'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1008</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1009</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1010</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">width</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">height</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1011</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1012</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1013</span> 
<span class='line'>1014</span> </span><span class="WHIT">  </span><span class="COMM">/** @private Call the method recursively on all child views. */</span><span class="WHIT">
<span class='line'>1015</span> </span><span class="WHIT">  </span><span class="NAME">_callOnChildViews</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">methodName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">isTopDown</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">context</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1016</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">childView</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1017</span> </span><span class="WHIT">      </span><span class="NAME">childViews</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'childViews'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1018</span> </span><span class="WHIT">      </span><span class="NAME">method</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1019</span> </span><span class="WHIT">      </span><span class="NAME">shouldContinue</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1020</span> 
<span class='line'>1021</span> </span><span class="WHIT">    </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">childViews.length</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">--</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1022</span> </span><span class="WHIT">      </span><span class="NAME">childView</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">childViews</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1023</span> 
<span class='line'>1024</span> </span><span class="WHIT">      </span><span class="COMM">// We allow missing childViews in the array so ignore them.</span><span class="WHIT">
<span class='line'>1025</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">childView</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1026</span> 
<span class='line'>1027</span> </span><span class="WHIT">      </span><span class="COMM">// Look up the method on the child.</span><span class="WHIT">
<span class='line'>1028</span> </span><span class="WHIT">      </span><span class="NAME">method</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">childView</span><span class="PUNC">[</span><span class="NAME">methodName</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1029</span> 
<span class='line'>1030</span> </span><span class="WHIT">      </span><span class="COMM">// Call the method on this view *before* its children.</span><span class="WHIT">
<span class='line'>1031</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">isTopDown</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">isTopDown</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1032</span> </span><span class="WHIT">        </span><span class="NAME">shouldContinue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">method.call</span><span class="PUNC">(</span><span class="NAME">childView</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">context</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1033</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1034</span> 
<span class='line'>1035</span> </span><span class="WHIT">      </span><span class="COMM">// Recurse.</span><span class="WHIT">
<span class='line'>1036</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">shouldContinue</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">shouldContinue</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1037</span> </span><span class="WHIT">        </span><span class="NAME">childView._callOnChildViews</span><span class="PUNC">(</span><span class="NAME">methodName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">isTopDown</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">context</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1038</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1039</span> 
<span class='line'>1040</span> </span><span class="WHIT">      </span><span class="COMM">// Call the method on this view *after* its children.</span><span class="WHIT">
<span class='line'>1041</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">isTopDown</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1042</span> </span><span class="WHIT">        </span><span class="NAME">method.call</span><span class="PUNC">(</span><span class="NAME">childView</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">context</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1043</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1044</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1045</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1046</span> 
<span class='line'>1047</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>1048</span>     The clipping frame returns the visible portion of the view, taking into
<span class='line'>1049</span>     account the clippingFrame of the parent view.  (Note that, in contrast
<span class='line'>1050</span>     to `frame`, `clippingFrame` is in the context of the view itself, not
<span class='line'>1051</span>     its parent view.)
<span class='line'>1052</span> 
<span class='line'>1053</span>     Normally this will be calculated based on the intersection of your own
<span class='line'>1054</span>     clippingFrame and your parentView's clippingFrame.
<span class='line'>1055</span> 
<span class='line'>1056</span>     @type Rect
<span class='line'>1057</span>   */</span><span class="WHIT">
<span class='line'>1058</span> </span><span class="WHIT">  </span><span class="NAME">clippingFrame</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1059</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'frame'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1060</span> 
<span class='line'>1061</span> </span><span class="WHIT">    </span><span class="COMM">// FAST PATH: No frame, no clipping frame.</span><span class="WHIT">
<span class='line'>1062</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">f</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1063</span> 
<span class='line'>1064</span> </span><span class="WHIT">    </span><span class="COMM">/*jshint eqnull:true */</span><span class="WHIT">
<span class='line'>1065</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">scale</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">f.scale</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">f.scale</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1066</span> </span><span class="WHIT">        </span><span class="NAME">pv</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'parentView'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1067</span> </span><span class="WHIT">        </span><span class="NAME">pcf</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">pv</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">pv.get</span><span class="PUNC">(</span><span class="STRN">'clippingFrame'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1068</span> </span><span class="WHIT">        </span><span class="NAME">ret</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1069</span> 
<span class='line'>1070</span> </span><span class="WHIT">    </span><span class="COMM">// FAST PATH: No parent clipping frame, no change. (The origin and scale are reset from parent view's</span><span class="WHIT">
<span class='line'>1071</span> </span><span class="WHIT">    </span><span class="COMM">// context to our own.)</span><span class="WHIT">
<span class='line'>1072</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">pcf</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">width</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">f.width</span><span class="WHIT"> </span><span class="PUNC">/</span><span class="WHIT"> </span><span class="NAME">scale</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">height</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">f.height</span><span class="WHIT"> </span><span class="PUNC">/</span><span class="WHIT"> </span><span class="NAME">scale</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1073</span> 
<span class='line'>1074</span> </span><span class="WHIT">    </span><span class="COMM">// Get the intersection.</span><span class="WHIT">
<span class='line'>1075</span> </span><span class="WHIT">    </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.intersectRects</span><span class="PUNC">(</span><span class="NAME">pcf</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1076</span> 
<span class='line'>1077</span> </span><span class="WHIT">    </span><span class="COMM">// Reorient the top-left from the parent's origin to ours.</span><span class="WHIT">
<span class='line'>1078</span> </span><span class="WHIT">    </span><span class="NAME">ret.x</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">f.x</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1079</span> </span><span class="WHIT">    </span><span class="NAME">ret.y</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">f.y</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1080</span> 
<span class='line'>1081</span> </span><span class="WHIT">    </span><span class="COMM">// If we're scaled, we have to scale the intersected rectangle from our parent's frame of reference</span><span class="WHIT">
<span class='line'>1082</span> </span><span class="WHIT">    </span><span class="COMM">// to our own.</span><span class="WHIT">
<span class='line'>1083</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">scale</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1084</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">scaleX</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">scaleY</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1085</span> </span><span class="WHIT">      </span><span class="COMM">// We're scaling from parent space into our space, so the scale is reversed. (Layout scale may be an array.)</span><span class="WHIT">
<span class='line'>1086</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.typeOf</span><span class="PUNC">(</span><span class="NAME">scale</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">SC.T_ARRAY</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1087</span> </span><span class="WHIT">        </span><span class="NAME">scaleX</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">/</span><span class="WHIT"> </span><span class="NAME">scale</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1088</span> </span><span class="WHIT">        </span><span class="NAME">scaleY</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">/</span><span class="WHIT"> </span><span class="NAME">scale</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1089</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1090</span> </span><span class="WHIT">        </span><span class="NAME">scaleX</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">scaleY</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">/</span><span class="WHIT"> </span><span class="NAME">scale</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1091</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1092</span> 
<span class='line'>1093</span> </span><span class="WHIT">      </span><span class="COMM">// Convert the entire rectangle into our scale.</span><span class="WHIT">
<span class='line'>1094</span> </span><span class="WHIT">      </span><span class="NAME">ret.x</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">scaleX</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1095</span> </span><span class="WHIT">      </span><span class="NAME">ret.width</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">scaleX</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1096</span> </span><span class="WHIT">      </span><span class="NAME">ret.y</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">scaleY</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1097</span> </span><span class="WHIT">      </span><span class="NAME">ret.height</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">scaleY</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1098</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1099</span> 
<span class='line'>1100</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1101</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">.</span><span class="NAME">property</span><span class="PUNC">(</span><span class="STRN">'parentView'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'frame'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">cacheable</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1102</span> 
<span class='line'>1103</span> </span><span class="WHIT">  </span><span class="COMM">/** @private
<span class='line'>1104</span>     This method is invoked whenever the clippingFrame changes, notifying
<span class='line'>1105</span>     each child view that its clippingFrame has also changed.
<span class='line'>1106</span>   */</span><span class="WHIT">
<span class='line'>1107</span> </span><span class="WHIT">  </span><span class="NAME">_sc_view_clippingFrameDidChange</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1108</span> </span><span class="WHIT">    </span><span class="NAME">this.notifyPropertyChange</span><span class="PUNC">(</span><span class="STRN">'clippingFrame'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1109</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1110</span> 
<span class='line'>1111</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>1112</span>     Removes the child view from the parent view *and* detaches it from the
<span class='line'>1113</span>     document.
<span class='line'>1114</span> 
<span class='line'>1115</span>     This does *not* remove the child view's layer (i.e. the node still exists,
<span class='line'>1116</span>     but is no longer in the document) and does *not* destroy the child view
<span class='line'>1117</span>     (i.e. it can still be re-attached to the document).
<span class='line'>1118</span> 
<span class='line'>1119</span>     Note that if the child view uses a transitionOut plugin, it will not be
<span class='line'>1120</span>     fully detached until the transition completes.  To force the view to detach
<span class='line'>1121</span>     immediately you can pass true for the optional `immediately` argument.
<span class='line'>1122</span> 
<span class='line'>1123</span>     If you wish to remove the child and discard it, use `removeChildAndDestroy`.
<span class='line'>1124</span> 
<span class='line'>1125</span>     @param {SC.View} view The view to remove as a child view.
<span class='line'>1126</span>     @param {Boolean} [immediately=false] Forces the child view to be removed immediately regardless if it uses a transitionOut plugin.
<span class='line'>1127</span>     @see SC.View#removeChildAndDestroy
<span class='line'>1128</span>     @returns {SC.View} receiver
<span class='line'>1129</span>   */</span><span class="WHIT">
<span class='line'>1130</span> </span><span class="WHIT">  </span><span class="NAME">removeChild</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">immediately</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1131</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">view.get</span><span class="PUNC">(</span><span class="STRN">'isAttached'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1132</span> </span><span class="WHIT">      </span><span class="NAME">view._doDetach</span><span class="PUNC">(</span><span class="NAME">immediately</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1133</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1134</span> 
<span class='line'>1135</span> </span><span class="WHIT">    </span><span class="COMM">// If the view will transition out, wait for the transition to complete</span><span class="WHIT">
<span class='line'>1136</span> </span><span class="WHIT">    </span><span class="COMM">// before orphaning the view entirely.</span><span class="WHIT">
<span class='line'>1137</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">immediately</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">view.get</span><span class="PUNC">(</span><span class="STRN">'viewState'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">SC.CoreView.ATTACHED_BUILDING_OUT</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1138</span> </span><span class="WHIT">      </span><span class="NAME">view.addObserver</span><span class="PUNC">(</span><span class="STRN">'isAttached'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._orphanChildView</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1139</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1140</span> </span><span class="WHIT">      </span><span class="NAME">view._doOrphan</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1141</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1142</span> 
<span class='line'>1143</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1144</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1145</span> 
<span class='line'>1146</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>1147</span>     Removes the child view from the parent view, detaches it from the document
<span class='line'>1148</span>     *and* destroys the view and its layer.
<span class='line'>1149</span> 
<span class='line'>1150</span>     Note that if the child view uses a transitionOut plugin, it will not be
<span class='line'>1151</span>     fully detached and destroyed until the transition completes.  To force the
<span class='line'>1152</span>     view to detach immediately you can pass true for the optional `immediately`
<span class='line'>1153</span>     argument.
<span class='line'>1154</span> 
<span class='line'>1155</span>     If you wish to remove the child and keep it for further re-use, use
<span class='line'>1156</span>     `removeChild`.
<span class='line'>1157</span> 
<span class='line'>1158</span>     @param {SC.View} view The view to remove as a child view and destroy.
<span class='line'>1159</span>     @param {Boolean} [immediately=false] Forces the child view to be removed and destroyed immediately regardless if it uses a transitionOut plugin.
<span class='line'>1160</span>     @see SC.View#removeChild
<span class='line'>1161</span>     @returns {SC.View} receiver
<span class='line'>1162</span>   */</span><span class="WHIT">
<span class='line'>1163</span> </span><span class="WHIT">  </span><span class="NAME">removeChildAndDestroy</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">immediately</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1164</span> </span><span class="WHIT">    </span><span class="NAME">view._doDetach</span><span class="PUNC">(</span><span class="NAME">immediately</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1165</span> 
<span class='line'>1166</span> </span><span class="WHIT">    </span><span class="COMM">// If the view will transition out, wait for the transition to complete</span><span class="WHIT">
<span class='line'>1167</span> </span><span class="WHIT">    </span><span class="COMM">// before destroying the view entirely.</span><span class="WHIT">
<span class='line'>1168</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">view.get</span><span class="PUNC">(</span><span class="STRN">'transitionOut'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">immediately</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1169</span> </span><span class="WHIT">      </span><span class="NAME">view.addObserver</span><span class="PUNC">(</span><span class="STRN">'isAttached'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._destroyChildView</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1170</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1171</span> </span><span class="WHIT">      </span><span class="NAME">view.destroy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Destroys the layer and the view.</span><span class="WHIT">
<span class='line'>1172</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1173</span> 
<span class='line'>1174</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1175</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1176</span> 
<span class='line'>1177</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>1178</span>     Removes all children from the parentView *and* destroys them and their
<span class='line'>1179</span>     layers.
<span class='line'>1180</span> 
<span class='line'>1181</span>     Note that if any child view uses a transitionOut plugin, it will not be
<span class='line'>1182</span>     fully removed until the transition completes.  To force all child views to
<span class='line'>1183</span>     remove immediately you can pass true as the optional `immediately` argument.
<span class='line'>1184</span> 
<span class='line'>1185</span>     Tip: If you know that there are no transitions for the child views,
<span class='line'>1186</span>     you should pass true to optimize the document removal.
<span class='line'>1187</span> 
<span class='line'>1188</span>     @param {Boolean} [immediately=false] Forces all child views to be removed immediately regardless if any uses a transitionOut plugin.
<span class='line'>1189</span>     @returns {SC.View} receiver
<span class='line'>1190</span>   */</span><span class="WHIT">
<span class='line'>1191</span> </span><span class="WHIT">  </span><span class="NAME">removeAllChildren</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">immediately</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1192</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">childViews</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'childViews'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1193</span> </span><span class="WHIT">      </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">childViews.get</span><span class="PUNC">(</span><span class="STRN">'length'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1194</span> </span><span class="WHIT">      </span><span class="NAME">i</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1195</span> 
<span class='line'>1196</span> </span><span class="WHIT">    </span><span class="COMM">// OPTIMIZATION!</span><span class="WHIT">
<span class='line'>1197</span> </span><span class="WHIT">    </span><span class="COMM">// If we know that we're removing all children and we are rendered, lets do the document cleanup in one sweep.</span><span class="WHIT">
<span class='line'>1198</span> </span><span class="WHIT">    </span><span class="COMM">// if (immediately && this.get('_isRendered')) {</span><span class="WHIT">
<span class='line'>1199</span> </span><span class="WHIT">    </span><span class="COMM">//   var layer,</span><span class="WHIT">
<span class='line'>1200</span> </span><span class="WHIT">    </span><span class="COMM">//     parentNode;</span><span class="WHIT">
<span class='line'>1201</span> 
<span class='line'>1202</span> </span><span class="WHIT">    </span><span class="COMM">//   // If attached, detach and track our parent node so we can re-attach.</span><span class="WHIT">
<span class='line'>1203</span> </span><span class="WHIT">    </span><span class="COMM">//   if (this.get('isAttached')) {</span><span class="WHIT">
<span class='line'>1204</span> </span><span class="WHIT">    </span><span class="COMM">//     layer = this.get('layer');</span><span class="WHIT">
<span class='line'>1205</span> </span><span class="WHIT">    </span><span class="COMM">//     parentNode = layer.parentNode;</span><span class="WHIT">
<span class='line'>1206</span> 
<span class='line'>1207</span> </span><span class="WHIT">    </span><span class="COMM">//     this._doDetach();</span><span class="WHIT">
<span class='line'>1208</span> </span><span class="WHIT">    </span><span class="COMM">//   }</span><span class="WHIT">
<span class='line'>1209</span> 
<span class='line'>1210</span> </span><span class="WHIT">    </span><span class="COMM">//   // Destroy our layer and thus all the children's layers in one move.</span><span class="WHIT">
<span class='line'>1211</span> </span><span class="WHIT">    </span><span class="COMM">//   this.destroyLayer();</span><span class="WHIT">
<span class='line'>1212</span> 
<span class='line'>1213</span> </span><span class="WHIT">    </span><span class="COMM">//   // Remove all the children.</span><span class="WHIT">
<span class='line'>1214</span> </span><span class="WHIT">    </span><span class="COMM">//   for (i = len - 1; i >= 0; i--) {</span><span class="WHIT">
<span class='line'>1215</span> </span><span class="WHIT">    </span><span class="COMM">//     this.removeChildAndDestroy(childViews.objectAt(i), immediately);</span><span class="WHIT">
<span class='line'>1216</span> </span><span class="WHIT">    </span><span class="COMM">//   }</span><span class="WHIT">
<span class='line'>1217</span> 
<span class='line'>1218</span> </span><span class="WHIT">    </span><span class="COMM">//   // Recreate our layer (now empty).</span><span class="WHIT">
<span class='line'>1219</span> </span><span class="WHIT">    </span><span class="COMM">//   this.createLayer();</span><span class="WHIT">
<span class='line'>1220</span> 
<span class='line'>1221</span> </span><span class="WHIT">    </span><span class="COMM">//   // Reattach our layer.</span><span class="WHIT">
<span class='line'>1222</span> </span><span class="WHIT">    </span><span class="COMM">//   if (parentNode && !this.get('isAttached')) { this._doAttach(parentNode); }</span><span class="WHIT">
<span class='line'>1223</span> </span><span class="WHIT">    </span><span class="COMM">// } else {</span><span class="WHIT">
<span class='line'>1224</span> </span><span class="WHIT">      </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">--</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1225</span> </span><span class="WHIT">        </span><span class="NAME">this.removeChildAndDestroy</span><span class="PUNC">(</span><span class="NAME">childViews.objectAt</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">immediately</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1226</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1227</span> </span><span class="WHIT">    </span><span class="COMM">// }</span><span class="WHIT">
<span class='line'>1228</span> 
<span class='line'>1229</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1230</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1231</span> 
<span class='line'>1232</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>1233</span>     Removes the view from its parentView, if one is found.  Otherwise
<span class='line'>1234</span>     does nothing.
<span class='line'>1235</span> 
<span class='line'>1236</span>     @returns {SC.View} receiver
<span class='line'>1237</span>   */</span><span class="WHIT">
<span class='line'>1238</span> </span><span class="WHIT">  </span><span class="NAME">removeFromParent</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1239</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'parentView'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1240</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">parent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">parent.removeChild</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1241</span> 
<span class='line'>1242</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1243</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1244</span> 
<span class='line'>1245</span> </span><span class="WHIT">  </span><span class="COMM">/** @private Observer for child views that are being discarded after transitioning out. */</span><span class="WHIT">
<span class='line'>1246</span> </span><span class="WHIT">  </span><span class="NAME">_destroyChildView</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1247</span> </span><span class="WHIT">    </span><span class="COMM">// Commence destroying of the view once it is detached.</span><span class="WHIT">
<span class='line'>1248</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">view.get</span><span class="PUNC">(</span><span class="STRN">'isAttached'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1249</span> </span><span class="WHIT">      </span><span class="NAME">view.removeObserver</span><span class="PUNC">(</span><span class="STRN">'isAttached'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._destroyChildView</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1250</span> </span><span class="WHIT">      </span><span class="NAME">view.destroy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1251</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1252</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1253</span> 
<span class='line'>1254</span> </span><span class="WHIT">  </span><span class="COMM">/** @private Observer for child views that are being orphaned after transitioning out. */</span><span class="WHIT">
<span class='line'>1255</span> </span><span class="WHIT">  </span><span class="NAME">_orphanChildView</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1256</span> </span><span class="WHIT">    </span><span class="COMM">// Commence orphaning of the view once it is detached.</span><span class="WHIT">
<span class='line'>1257</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">view.get</span><span class="PUNC">(</span><span class="STRN">'isAttached'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1258</span> </span><span class="WHIT">      </span><span class="NAME">view.removeObserver</span><span class="PUNC">(</span><span class="STRN">'isAttached'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._orphanChildView</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1259</span> </span><span class="WHIT">      </span><span class="NAME">view._doOrphan</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1260</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1261</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1262</span> 
<span class='line'>1263</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>1264</span>     Completely destroys a view instance so that it may be garbage collected.
<span class='line'>1265</span> 
<span class='line'>1266</span>     You must call this method on a view to destroy the view (and all of its
<span class='line'>1267</span>     child views). This will remove the view from any parent, detach the
<span class='line'>1268</span>     view's layer from the DOM if it is attached and clear the view's layer
<span class='line'>1269</span>     if it is rendered.
<span class='line'>1270</span> 
<span class='line'>1271</span>     Once a view is destroyed it can *not* be reused.
<span class='line'>1272</span> 
<span class='line'>1273</span>     @returns {SC.View} receiver
<span class='line'>1274</span>   */</span><span class="WHIT">
<span class='line'>1275</span> </span><span class="WHIT">  </span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1276</span> </span><span class="WHIT">    </span><span class="COMM">// Fast path!</span><span class="WHIT">
<span class='line'>1277</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'isDestroyed'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1278</span> 
<span class='line'>1279</span> </span><span class="WHIT">    </span><span class="COMM">// Do generic destroy. It takes care of mixins and sets isDestroyed to YES.</span><span class="WHIT">
<span class='line'>1280</span> </span><span class="WHIT">    </span><span class="COMM">// Do this first, since it cleans up bindings that may apply to parentView</span><span class="WHIT">
<span class='line'>1281</span> </span><span class="WHIT">    </span><span class="COMM">// (which we will soon null out).</span><span class="WHIT">
<span class='line'>1282</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">sc_super</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1283</span> 
<span class='line'>1284</span> </span><span class="WHIT">    </span><span class="COMM">// If our parent is already destroyed, then we can defer destroying ourself</span><span class="WHIT">
<span class='line'>1285</span> </span><span class="WHIT">    </span><span class="COMM">// and our own child views momentarily.</span><span class="WHIT">
<span class='line'>1286</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.getPath</span><span class="PUNC">(</span><span class="STRN">'parentView.isDestroyed'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1287</span> </span><span class="WHIT">      </span><span class="COMM">// Complete the destroy in a bit.</span><span class="WHIT">
<span class='line'>1288</span> </span><span class="WHIT">      </span><span class="NAME">this.invokeNext</span><span class="PUNC">(</span><span class="NAME">this._destroy</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1289</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1290</span> </span><span class="WHIT">      </span><span class="COMM">// Immediately remove the layer if attached (ignores transitionOut). This</span><span class="WHIT">
<span class='line'>1291</span> </span><span class="WHIT">      </span><span class="COMM">// will detach the layer for all child views as well.</span><span class="WHIT">
<span class='line'>1292</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'isAttached'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1293</span> </span><span class="WHIT">        </span><span class="NAME">this._doDetach</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1294</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1295</span> 
<span class='line'>1296</span> </span><span class="WHIT">      </span><span class="COMM">// Clear the layer if rendered.  This will clear all child views layer</span><span class="WHIT">
<span class='line'>1297</span> </span><span class="WHIT">      </span><span class="COMM">// references as well.</span><span class="WHIT">
<span class='line'>1298</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'_isRendered'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1299</span> </span><span class="WHIT">        </span><span class="NAME">this._doDestroyLayer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1300</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1301</span> 
<span class='line'>1302</span> </span><span class="WHIT">      </span><span class="COMM">// Complete the destroy.</span><span class="WHIT">
<span class='line'>1303</span> </span><span class="WHIT">      </span><span class="NAME">this._destroy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1304</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1305</span> 
<span class='line'>1306</span> </span><span class="WHIT">    </span><span class="COMM">// Remove the view from the global hash.</span><span class="WHIT">
<span class='line'>1307</span> </span><span class="WHIT">    </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">SC.View.views</span><span class="PUNC">[</span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'layerId'</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1308</span> 
<span class='line'>1309</span> </span><span class="WHIT">    </span><span class="COMM">// Destroy any children.  Loop backwards since childViews will shrink.</span><span class="WHIT">
<span class='line'>1310</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">childViews</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'childViews'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1311</span> </span><span class="WHIT">    </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">childViews.length</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">--</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1312</span> </span><span class="WHIT">      </span><span class="NAME">childViews</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">destroy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1313</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1314</span> 
<span class='line'>1315</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1316</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1317</span> 
<span class='line'>1318</span> </span><span class="WHIT">  </span><span class="COMM">/** @private */</span><span class="WHIT">
<span class='line'>1319</span> </span><span class="WHIT">  </span><span class="NAME">_destroy</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1320</span> </span><span class="WHIT">    </span><span class="COMM">// Orphan the view if adopted.</span><span class="WHIT">
<span class='line'>1321</span> </span><span class="WHIT">    </span><span class="NAME">this._doOrphan</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1322</span> 
<span class='line'>1323</span> </span><span class="WHIT">    </span><span class="COMM">// TODO: Deprecate owner in this sense.</span><span class="WHIT">
<span class='line'>1324</span> </span><span class="WHIT">    </span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="STRN">'owner'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1325</span> </span><span class="WHIT">    </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.page</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1326</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1327</span> 
<span class='line'>1328</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>1329</span>     This method is called when your view is first created to setup any  child
<span class='line'>1330</span>     views that are already defined on your class.  If any are found, it will
<span class='line'>1331</span>     instantiate them for you.
<span class='line'>1332</span> 
<span class='line'>1333</span>     The default implementation of this method simply steps through your
<span class='line'>1334</span>     childViews array, which is expects to either be empty or to contain View
<span class='line'>1335</span>     designs that can be instantiated
<span class='line'>1336</span> 
<span class='line'>1337</span>     Alternatively, you can implement this method yourself in your own
<span class='line'>1338</span>     subclasses to look for views defined on specific properties and then build
<span class='line'>1339</span>      a childViews array yourself.
<span class='line'>1340</span> 
<span class='line'>1341</span>     Note that when you implement this method yourself, you should never
<span class='line'>1342</span>     instantiate views directly.  Instead, you should use
<span class='line'>1343</span>     this.createChildView() method instead.  This method can be much faster in
<span class='line'>1344</span>     a production environment than creating views yourself.
<span class='line'>1345</span> 
<span class='line'>1346</span>     @returns {SC.View} receiver
<span class='line'>1347</span>   */</span><span class="WHIT">
<span class='line'>1348</span> </span><span class="WHIT">  </span><span class="NAME">createChildViews</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1349</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">childViews</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'childViews'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1350</span> </span><span class="WHIT">        </span><span class="NAME">len</span><span class="WHIT">        </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">childViews.length</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1351</span> </span><span class="WHIT">        </span><span class="NAME">isNoLongerValid</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1352</span> </span><span class="WHIT">        </span><span class="NAME">idx</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">view</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1353</span> 
<span class='line'>1354</span> </span><span class="WHIT">    </span><span class="NAME">this.beginPropertyChanges</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1355</span> 
<span class='line'>1356</span> </span><span class="WHIT">    </span><span class="COMM">// swap the array</span><span class="WHIT">
<span class='line'>1357</span> </span><span class="WHIT">    </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">++</span><span class="NAME">idx</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1358</span> </span><span class="WHIT">      </span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">view</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">childViews</span><span class="PUNC">[</span><span class="NAME">idx</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1359</span> 
<span class='line'>1360</span> </span><span class="WHIT">      </span><span class="COMM">// is this is a key name, lookup view class</span><span class="WHIT">
<span class='line'>1361</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">SC.T_STRING</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1362</span> </span><span class="WHIT">        </span><span class="NAME">view</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1363</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1364</span> </span><span class="WHIT">        </span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1365</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1366</span> 
<span class='line'>1367</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">view</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1368</span> </span><span class="WHIT">        </span><span class="COMM">//@if (debug)</span><span class="WHIT">
<span class='line'>1369</span> </span><span class="WHIT">        </span><span class="NAME">SC.warn</span><span class="PUNC">(</span><span class="STRN">"Developer Warning: The child view named '%@' was not found in the view, %@.  This child view will be ignored."</span><span class="PUNC">.</span><span class="NAME">fmt</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1370</span> </span><span class="WHIT">        </span><span class="COMM">//@endif</span><span class="WHIT">
<span class='line'>1371</span> 
<span class='line'>1372</span> </span><span class="WHIT">        </span><span class="COMM">// skip this one.</span><span class="WHIT">
<span class='line'>1373</span> </span><span class="WHIT">        </span><span class="NAME">isNoLongerValid</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1374</span> </span><span class="WHIT">        </span><span class="NAME">childViews</span><span class="PUNC">[</span><span class="NAME">idx</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1375</span> </span><span class="WHIT">        </span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1376</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1377</span> 
<span class='line'>1378</span> </span><span class="WHIT">      </span><span class="COMM">// createChildView creates the view if necessary, but also sets</span><span class="WHIT">
<span class='line'>1379</span> </span><span class="WHIT">      </span><span class="COMM">// important properties, such as parentView</span><span class="WHIT">
<span class='line'>1380</span> </span><span class="WHIT">      </span><span class="NAME">view</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.createChildView</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1381</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">view</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="COMM">// save on key name if passed</span><span class="WHIT">
<span class='line'>1382</span> 
<span class='line'>1383</span> </span><span class="WHIT">      </span><span class="NAME">childViews</span><span class="PUNC">[</span><span class="NAME">idx</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">view</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1384</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1385</span> 
<span class='line'>1386</span> </span><span class="WHIT">    </span><span class="COMM">// Set childViews to be only the valid array.</span><span class="WHIT">
<span class='line'>1387</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">isNoLongerValid</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="STRN">'childViews'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">childViews.compact</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1388</span> 
<span class='line'>1389</span> </span><span class="WHIT">    </span><span class="NAME">this.endPropertyChanges</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1390</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1391</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1392</span> 
<span class='line'>1393</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>1394</span>     Instantiates a view to be added to the childViews array during view
<span class='line'>1395</span>     initialization. You generally will not call this method directly unless
<span class='line'>1396</span>     you are overriding createChildViews(). Note that this method will
<span class='line'>1397</span>     automatically configure the correct settings on the new view instance to
<span class='line'>1398</span>     act as a child of the parent.
<span class='line'>1399</span> 
<span class='line'>1400</span>     If the given view is a class, then createdByParent will be set to true on
<span class='line'>1401</span>     the returned instance.
<span class='line'>1402</span> 
<span class='line'>1403</span>     @param {Class} view A view class to create or view instance to prepare.
<span class='line'>1404</span>     @param {Object} [attrs={}] attributes to add
<span class='line'>1405</span>     @returns {SC.View} new instance
<span class='line'>1406</span>     @test in createChildViews
<span class='line'>1407</span>   */</span><span class="WHIT">
<span class='line'>1408</span> </span><span class="WHIT">  </span><span class="NAME">createChildView</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">attrs</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1409</span> </span><span class="WHIT">    </span><span class="COMM">// Create the view if it is a class.</span><span class="WHIT">
<span class='line'>1410</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">view.isClass</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1411</span> </span><span class="WHIT">      </span><span class="COMM">// attrs should always exist...</span><span class="WHIT">
<span class='line'>1412</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">attrs</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">attrs</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1413</span> 
<span class='line'>1414</span> </span><span class="WHIT">      </span><span class="COMM">// clone the hash that was given so we do not pollute it if it's being reused</span><span class="WHIT">
<span class='line'>1415</span> </span><span class="WHIT">      </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">attrs</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.clone</span><span class="PUNC">(</span><span class="NAME">attrs</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1416</span> 
<span class='line'>1417</span> </span><span class="WHIT">      </span><span class="COMM">// Assign the owner, parentView & page to ourself.</span><span class="WHIT">
<span class='line'>1418</span> </span><span class="WHIT">      </span><span class="NAME">attrs.owner</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">attrs.parentView</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1419</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">attrs.page</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">attrs.page</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.page</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1420</span> 
<span class='line'>1421</span> </span><span class="WHIT">      </span><span class="COMM">// Track that we created this view.</span><span class="WHIT">
<span class='line'>1422</span> </span><span class="WHIT">      </span><span class="NAME">attrs.createdByParent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1423</span> 
<span class='line'>1424</span> </span><span class="WHIT">      </span><span class="COMM">// Insert the autoMixins if defined</span><span class="WHIT">
<span class='line'>1425</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">applyMixins</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.autoMixins</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1426</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">applyMixins</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1427</span> </span><span class="WHIT">        </span><span class="NAME">applyMixins</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.clone</span><span class="PUNC">(</span><span class="NAME">applyMixins</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1428</span> </span><span class="WHIT">        </span><span class="NAME">applyMixins.push</span><span class="PUNC">(</span><span class="NAME">attrs</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1429</span> </span><span class="WHIT">        </span><span class="NAME">view</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">view.create.apply</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">applyMixins</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1430</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1431</span> </span><span class="WHIT">        </span><span class="NAME">view</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">view.create</span><span class="PUNC">(</span><span class="NAME">attrs</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1432</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1433</span> </span><span class="WHIT">    </span><span class="COMM">// Assign the parentView & owner if the view is an instance.</span><span class="WHIT">
<span class='line'>1434</span> </span><span class="WHIT">    </span><span class="COMM">// TODO: This should not be accepting view instances, for the purpose of lazy code elsewhere in the framework.</span><span class="WHIT">
<span class='line'>1435</span> </span><span class="WHIT">    </span><span class="COMM">//       We should ensure users of `createChildViews` are using appendChild and other manipulation methods.</span><span class="WHIT">
<span class='line'>1436</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1437</span> </span><span class="WHIT">      </span><span class="NAME">view.set</span><span class="PUNC">(</span><span class="STRN">'parentView'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1438</span> </span><span class="WHIT">      </span><span class="NAME">view.set</span><span class="PUNC">(</span><span class="STRN">'owner'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1439</span> </span><span class="WHIT">      </span><span class="NAME">view._adopted</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1440</span> 
<span class='line'>1441</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">view.get</span><span class="PUNC">(</span><span class="STRN">'page'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">view.set</span><span class="PUNC">(</span><span class="STRN">'page'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.page</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1442</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1443</span> 
<span class='line'>1444</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">view</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1445</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1446</span> 
<span class='line'>1447</span> </span><span class="WHIT">  </span><span class="COMM">/** walk like a duck */</span><span class="WHIT">
<span class='line'>1448</span> </span><span class="WHIT">  </span><span class="NAME">isView</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1449</span> 
<span class='line'>1450</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>1451</span>     Default method called when a selectstart event is triggered. This event is
<span class='line'>1452</span>     only supported by IE. Used in sproutcore to disable text selection and
<span class='line'>1453</span>     IE8 accelerators. The accelerators will be enabled only in
<span class='line'>1454</span>     text selectable views. In FF and Safari we use the css style 'allow-select'.
<span class='line'>1455</span> 
<span class='line'>1456</span>     If you want to enable text selection in certain controls is recommended
<span class='line'>1457</span>     to override this function to always return YES , instead of setting
<span class='line'>1458</span>     isTextSelectable to true.
<span class='line'>1459</span> 
<span class='line'>1460</span>     For example in textfield you do not want to enable textSelection on the text
<span class='line'>1461</span>     hint only on the actual text you are entering. You can achieve that by
<span class='line'>1462</span>     only overriding this method.
<span class='line'>1463</span> 
<span class='line'>1464</span>     @param evt {SC.Event} the selectstart event
<span class='line'>1465</span>     @returns YES if selectable
<span class='line'>1466</span>   */</span><span class="WHIT">
<span class='line'>1467</span> </span><span class="WHIT">  </span><span class="NAME">selectStart</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">evt</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1468</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'isTextSelectable'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1469</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1470</span> 
<span class='line'>1471</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>1472</span>     Used to block the contextMenu per view.
<span class='line'>1473</span> 
<span class='line'>1474</span>     @param evt {SC.Event} the contextmenu event
<span class='line'>1475</span>     @returns YES if the contextmenu will be allowed to show up
<span class='line'>1476</span>   */</span><span class="WHIT">
<span class='line'>1477</span> </span><span class="WHIT">  </span><span class="NAME">contextMenu</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">evt</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1478</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'isContextMenuEnabled'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1479</span> </span><span class="WHIT">      </span><span class="NAME">evt.allowDefault</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1480</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1481</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1482</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1483</span> 
<span class='line'>1484</span> </span><span class="WHIT">  </span><span class="COMM">// ------------------------------------------------------------------------</span><span class="WHIT">
<span class='line'>1485</span> </span><span class="WHIT">  </span><span class="COMM">// Transitions</span><span class="WHIT">
<span class='line'>1486</span> </span><span class="WHIT">  </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>1487</span> 
<span class='line'>1488</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>1489</span>     The transition plugin to use when this view is appended to the DOM.
<span class='line'>1490</span> 
<span class='line'>1491</span>     SC.CoreView uses a pluggable transition architecture where the transition
<span class='line'>1492</span>     setup, execution and cleanup can be handled by a specified transition
<span class='line'>1493</span>     plugin.
<span class='line'>1494</span> 
<span class='line'>1495</span>     There are a number of pre-built transition plugins available in the
<span class='line'>1496</span>     foundation framework:
<span class='line'>1497</span> 
<span class='line'>1498</span>       SC.View.BOUNCE_IN
<span class='line'>1499</span>       SC.View.FADE_IN
<span class='line'>1500</span>       SC.View.SLIDE_IN
<span class='line'>1501</span>       SC.View.SCALE_IN
<span class='line'>1502</span>       SC.View.SPRING_IN
<span class='line'>1503</span> 
<span class='line'>1504</span>     You can even provide your own custom transition plugins.  Just create a
<span class='line'>1505</span>     transition object that conforms to the SC.ViewTransitionProtocol protocol.
<span class='line'>1506</span> 
<span class='line'>1507</span>     @type Object (SC.ViewTransitionProtocol)
<span class='line'>1508</span>     @default null
<span class='line'>1509</span>     @since Version 1.10
<span class='line'>1510</span>   */</span><span class="WHIT">
<span class='line'>1511</span> </span><span class="WHIT">  </span><span class="NAME">transitionIn</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1512</span> 
<span class='line'>1513</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>1514</span>     The options for the given transition in plugin.
<span class='line'>1515</span> 
<span class='line'>1516</span>     These options are specific to the current transition plugin used and are
<span class='line'>1517</span>     used to modify the transition animation.  To determine what options
<span class='line'>1518</span>     may be used for a given plugin and to see what the default options are,
<span class='line'>1519</span>     see the documentation for the transition plugin being used.
<span class='line'>1520</span> 
<span class='line'>1521</span>     Most transitions will accept a duration and timing option, but may
<span class='line'>1522</span>     also use other options.  For example, SC.View.SLIDE_IN accepts options
<span class='line'>1523</span>     like:
<span class='line'>1524</span> 
<span class='line'>1525</span>         transitionInOptions: {
<span class='line'>1526</span>           direction: 'left',
<span class='line'>1527</span>           duration: 0.25,
<span class='line'>1528</span>           timing: 'ease-in-out'
<span class='line'>1529</span>         }
<span class='line'>1530</span> 
<span class='line'>1531</span>     @type Object
<span class='line'>1532</span>     @default null
<span class='line'>1533</span>     @since Version 1.10
<span class='line'>1534</span>   */</span><span class="WHIT">
<span class='line'>1535</span> </span><span class="WHIT">  </span><span class="NAME">transitionInOptions</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1536</span> 
<span class='line'>1537</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>1538</span>     The transition plugin to use when this view is removed from the DOM.
<span class='line'>1539</span> 
<span class='line'>1540</span>     SC.View uses a pluggable transition architecture where the transition setup,
<span class='line'>1541</span>     execution and cleanup can be handled by a specified transition plugin.
<span class='line'>1542</span> 
<span class='line'>1543</span>     There are a number of pre-built transition plugins available in the
<span class='line'>1544</span>     foundation framework:
<span class='line'>1545</span> 
<span class='line'>1546</span>       SC.View.BOUNCE_OUT
<span class='line'>1547</span>       SC.View.FADE_OUT
<span class='line'>1548</span>       SC.View.SLIDE_OUT
<span class='line'>1549</span>       SC.View.SCALE_OUT
<span class='line'>1550</span>       SC.View.SPRING_OUT
<span class='line'>1551</span> 
<span class='line'>1552</span>     You can even provide your own custom transition plugins.  Just create a
<span class='line'>1553</span>     transition object that conforms to the SC.ViewTransitionProtocol protocol.
<span class='line'>1554</span> 
<span class='line'>1555</span>     @type Object (SC.ViewTransitionProtocol)
<span class='line'>1556</span>     @default null
<span class='line'>1557</span>     @since Version 1.10
<span class='line'>1558</span>   */</span><span class="WHIT">
<span class='line'>1559</span> </span><span class="WHIT">  </span><span class="NAME">transitionOut</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1560</span> 
<span class='line'>1561</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>1562</span>     The options for the given transition out plugin.
<span class='line'>1563</span> 
<span class='line'>1564</span>     These options are specific to the current transition plugin used and are
<span class='line'>1565</span>     used to modify the transition animation.  To determine what options
<span class='line'>1566</span>     may be used for a given plugin and to see what the default options are,
<span class='line'>1567</span>     see the documentation for the transition plugin being used.
<span class='line'>1568</span> 
<span class='line'>1569</span>     Most transitions will accept a duration and timing option, but may
<span class='line'>1570</span>     also use other options.  For example, SC.View.SLIDE accepts options
<span class='line'>1571</span>     like:
<span class='line'>1572</span> 
<span class='line'>1573</span>         transitionOutOptions: {
<span class='line'>1574</span>           direction: 'right',
<span class='line'>1575</span>           duration: 0.15,
<span class='line'>1576</span>           timing: 'ease-in'
<span class='line'>1577</span>         }
<span class='line'>1578</span> 
<span class='line'>1579</span>     @type Object
<span class='line'>1580</span>     @default null
<span class='line'>1581</span>     @since Version 1.10
<span class='line'>1582</span>   */</span><span class="WHIT">
<span class='line'>1583</span> </span><span class="WHIT">  </span><span class="NAME">transitionOutOptions</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1584</span> 
<span class='line'>1585</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>1586</span>     The transition plugin to use when this view is made shown from being
<span class='line'>1587</span>     hidden.
<span class='line'>1588</span> 
<span class='line'>1589</span>     SC.CoreView uses a pluggable transition architecture where the transition setup,
<span class='line'>1590</span>     execution and cleanup can be handled by a specified transition plugin.
<span class='line'>1591</span> 
<span class='line'>1592</span>     There are a number of pre-built transition plugins available in the
<span class='line'>1593</span>     foundation framework:
<span class='line'>1594</span> 
<span class='line'>1595</span>       SC.View.BOUNCE_IN
<span class='line'>1596</span>       SC.View.FADE_IN
<span class='line'>1597</span>       SC.View.SLIDE_IN
<span class='line'>1598</span>       SC.View.SCALE_IN
<span class='line'>1599</span>       SC.View.SPRING_IN
<span class='line'>1600</span> 
<span class='line'>1601</span>     You can even provide your own custom transition plugins.  Just create a
<span class='line'>1602</span>     transition object that conforms to the SC.ViewTransitionProtocol protocol.
<span class='line'>1603</span> 
<span class='line'>1604</span>     @type Object (SC.ViewTransitionProtocol)
<span class='line'>1605</span>     @default null
<span class='line'>1606</span>     @since Version 1.10
<span class='line'>1607</span>   */</span><span class="WHIT">
<span class='line'>1608</span> </span><span class="WHIT">  </span><span class="NAME">transitionShow</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1609</span> 
<span class='line'>1610</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>1611</span>     The options for the given transition show plugin.
<span class='line'>1612</span> 
<span class='line'>1613</span>     These options are specific to the current transition plugin used and are
<span class='line'>1614</span>     used to modify the transition animation.  To determine what options
<span class='line'>1615</span>     may be used for a given plugin and to see what the default options are,
<span class='line'>1616</span>     see the documentation for the transition plugin being used.
<span class='line'>1617</span> 
<span class='line'>1618</span>     Most transitions will accept a duration and timing option, but may
<span class='line'>1619</span>     also use other options.  For example, SC.View.SLIDE accepts options
<span class='line'>1620</span>     like:
<span class='line'>1621</span> 
<span class='line'>1622</span>         transitionShowOptions: {
<span class='line'>1623</span>           direction: 'left',
<span class='line'>1624</span>           duration: 0.25,
<span class='line'>1625</span>           timing: 'ease-in-out'
<span class='line'>1626</span>         }
<span class='line'>1627</span> 
<span class='line'>1628</span>     @type Object
<span class='line'>1629</span>     @default null
<span class='line'>1630</span>     @since Version 1.10
<span class='line'>1631</span>   */</span><span class="WHIT">
<span class='line'>1632</span> </span><span class="WHIT">  </span><span class="NAME">transitionShowOptions</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1633</span> 
<span class='line'>1634</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>1635</span>     The transition plugin to use when this view is hidden after being shown.
<span class='line'>1636</span> 
<span class='line'>1637</span>     SC.View uses a pluggable transition architecture where the transition setup,
<span class='line'>1638</span>     execution and cleanup can be handled by a specified transition plugin.
<span class='line'>1639</span> 
<span class='line'>1640</span>     There are a number of pre-built transition plugins available in the
<span class='line'>1641</span>     foundation framework:
<span class='line'>1642</span> 
<span class='line'>1643</span>       SC.View.BOUNCE_OUT
<span class='line'>1644</span>       SC.View.FADE_OUT
<span class='line'>1645</span>       SC.View.SLIDE_OUT
<span class='line'>1646</span>       SC.View.SCALE_OUT
<span class='line'>1647</span>       SC.View.SPRING_OUT
<span class='line'>1648</span> 
<span class='line'>1649</span>     You can even provide your own custom transition plugins.  Just create a
<span class='line'>1650</span>     transition object that conforms to the SC.ViewTransitionProtocol protocol.
<span class='line'>1651</span> 
<span class='line'>1652</span>     @type Object (SC.ViewTransitionProtocol)
<span class='line'>1653</span>     @default null
<span class='line'>1654</span>     @since Version 1.10
<span class='line'>1655</span>   */</span><span class="WHIT">
<span class='line'>1656</span> </span><span class="WHIT">  </span><span class="NAME">transitionHide</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1657</span> 
<span class='line'>1658</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>1659</span>     The options for the given transition hide plugin.
<span class='line'>1660</span> 
<span class='line'>1661</span>     These options are specific to the current transition plugin used and are
<span class='line'>1662</span>     used to modify the transition animation.  To determine what options
<span class='line'>1663</span>     may be used for a given plugin and to see what the default options are,
<span class='line'>1664</span>     see the documentation for the transition plugin being used.
<span class='line'>1665</span> 
<span class='line'>1666</span>     Most transitions will accept a duration and timing option, but may
<span class='line'>1667</span>     also use other options.  For example, SC.View.SLIDE accepts options
<span class='line'>1668</span>     like:
<span class='line'>1669</span> 
<span class='line'>1670</span>         transitionHideOptions: {
<span class='line'>1671</span>           direction: 'right',
<span class='line'>1672</span>           duration: 0.15,
<span class='line'>1673</span>           timing: 'ease-in'
<span class='line'>1674</span>         }
<span class='line'>1675</span> 
<span class='line'>1676</span>     @type Object
<span class='line'>1677</span>     @default null
<span class='line'>1678</span>     @since Version 1.10
<span class='line'>1679</span>   */</span><span class="WHIT">
<span class='line'>1680</span> </span><span class="WHIT">  </span><span class="NAME">transitionHideOptions</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1681</span> 
<span class='line'>1682</span> </span><span class="WHIT">  </span><span class="COMM">// ............................................</span><span class="WHIT">
<span class='line'>1683</span> </span><span class="WHIT">  </span><span class="COMM">// Patches</span><span class="WHIT">
<span class='line'>1684</span> </span><span class="WHIT">  </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>1685</span> 
<span class='line'>1686</span> </span><span class="WHIT">  </span><span class="COMM">/** @private
<span class='line'>1687</span>     Override this method to apply design modes to this view and
<span class='line'>1688</span>     its children.
<span class='line'>1689</span>     @see SC.View
<span class='line'>1690</span>   */</span><span class="WHIT">
<span class='line'>1691</span> </span><span class="WHIT">  </span><span class="NAME">updateDesignMode</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">lastDesignMode</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">designMode</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1692</span> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1693</span> 
<span class='line'>1694</span> </span><span class="NAME">SC.CoreView.mixin</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>1695</span> </span><span class="WHIT">  </span><span class="COMM">/** @scope SC.CoreView */</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1696</span> 
<span class='line'>1697</span> </span><span class="WHIT">  </span><span class="COMM">/** @private walk like a duck -- used by SC.Page */</span><span class="WHIT">
<span class='line'>1698</span> </span><span class="WHIT">  </span><span class="NAME">isViewClass</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1699</span> 
<span class='line'>1700</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>1701</span>     This method works just like extend() except that it will also preserve
<span class='line'>1702</span>     the passed attributes in case you want to use a view builder later, if
<span class='line'>1703</span>     needed.
<span class='line'>1704</span> 
<span class='line'>1705</span>     @param {Hash} attrs Attributes to add to view
<span class='line'>1706</span>     @returns {Class} SC.View subclass to create
<span class='line'>1707</span>     @function
<span class='line'>1708</span>   */</span><span class="WHIT">
<span class='line'>1709</span> </span><span class="WHIT">  </span><span class="NAME">design</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1710</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.isDesign</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1711</span> </span><span class="WHIT">      </span><span class="COMM">// @if (debug)</span><span class="WHIT">
<span class='line'>1712</span> </span><span class="WHIT">      </span><span class="NAME">SC.Logger.warn</span><span class="PUNC">(</span><span class="STRN">"Developer Warning: .design() was called twice for %@."</span><span class="PUNC">.</span><span class="NAME">fmt</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1713</span> </span><span class="WHIT">      </span><span class="COMM">// @endif</span><span class="WHIT">
<span class='line'>1714</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1715</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1716</span> 
<span class='line'>1717</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.extend.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1718</span> </span><span class="WHIT">    </span><span class="NAME">ret.isDesign</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1719</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.ViewDesigner</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1720</span> </span><span class="WHIT">      </span><span class="NAME">SC.ViewDesigner.didLoadDesign</span><span class="PUNC">(</span><span class="NAME">ret</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">SC.A</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1721</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1722</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1723</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1724</span> 
<span class='line'>1725</span> </span><span class="WHIT">  </span><span class="NAME">extend</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1726</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">last</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">arguments.length</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1727</span> 
<span class='line'>1728</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">last</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">SC.none</span><span class="PUNC">(</span><span class="NAME">last.theme</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1729</span> </span><span class="WHIT">      </span><span class="NAME">last.themeName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">last.theme</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1730</span> </span><span class="WHIT">      </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">last.theme</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1731</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1732</span> 
<span class='line'>1733</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">SC.Object.extend.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1734</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1735</span> 
<span class='line'>1736</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>1737</span>     Helper applies the layout to the prototype.
<span class='line'>1738</span>   */</span><span class="WHIT">
<span class='line'>1739</span> </span><span class="WHIT">  </span><span class="NAME">layout</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">layout</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1740</span> </span><span class="WHIT">    </span><span class="NAME">this.prototype.layout</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">layout</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1741</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1742</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1743</span> 
<span class='line'>1744</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>1745</span>     Helper applies the classNames to the prototype
<span class='line'>1746</span>   */</span><span class="WHIT">
<span class='line'>1747</span> </span><span class="WHIT">  </span><span class="NAME">classNames</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">sc</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1748</span> </span><span class="WHIT">    </span><span class="NAME">sc</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.prototype.classNames</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">concat</span><span class="PUNC">(</span><span class="NAME">sc</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1749</span> </span><span class="WHIT">    </span><span class="NAME">this.prototype.classNames</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">sc</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1750</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1751</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1752</span> 
<span class='line'>1753</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>1754</span>     Help applies the tagName
<span class='line'>1755</span>   */</span><span class="WHIT">
<span class='line'>1756</span> </span><span class="WHIT">  </span><span class="NAME">tagName</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tg</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1757</span> </span><span class="WHIT">    </span><span class="NAME">this.prototype.tagName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tg</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1758</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1759</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1760</span> 
<span class='line'>1761</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>1762</span>     Helper adds the childView
<span class='line'>1763</span>   */</span><span class="WHIT">
<span class='line'>1764</span> </span><span class="WHIT">  </span><span class="NAME">childView</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">cv</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1765</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">childViews</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.prototype.childViews</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1766</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">childViews</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">this.superclass.prototype.childViews</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1767</span> </span><span class="WHIT">      </span><span class="NAME">childViews</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">childViews.slice</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1768</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1769</span> </span><span class="WHIT">    </span><span class="NAME">childViews.push</span><span class="PUNC">(</span><span class="NAME">cv</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1770</span> </span><span class="WHIT">    </span><span class="NAME">this.prototype.childViews</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">childViews</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1771</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1772</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1773</span> 
<span class='line'>1774</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>1775</span>     Helper adds a binding to a design
<span class='line'>1776</span>   */</span><span class="WHIT">
<span class='line'>1777</span> </span><span class="WHIT">  </span><span class="NAME">bind</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">keyName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">path</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1778</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.prototype</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">s</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.superclass.prototype</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1779</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">bindings</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">p._bindings</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1780</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">bindings</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">bindings</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">s._bindings</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1781</span> </span><span class="WHIT">      </span><span class="NAME">bindings</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">p._bindings</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">bindings</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">slice</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1782</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1783</span> 
<span class='line'>1784</span> </span><span class="WHIT">    </span><span class="NAME">keyName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">keyName</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"Binding"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1785</span> </span><span class="WHIT">    </span><span class="NAME">p</span><span class="PUNC">[</span><span class="NAME">keyName</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">path</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1786</span> </span><span class="WHIT">    </span><span class="NAME">bindings.push</span><span class="PUNC">(</span><span class="NAME">keyName</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1787</span> 
<span class='line'>1788</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1789</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1790</span> 
<span class='line'>1791</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>1792</span>     Helper sets a generic property on a design.
<span class='line'>1793</span>   */</span><span class="WHIT">
<span class='line'>1794</span> </span><span class="WHIT">  </span><span class="NAME">prop</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">keyName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1795</span> </span><span class="WHIT">    </span><span class="NAME">this.prototype</span><span class="PUNC">[</span><span class="NAME">keyName</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1796</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1797</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1798</span> 
<span class='line'>1799</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>1800</span>     Used to construct a localization for a view.  The default implementation
<span class='line'>1801</span>     will simply return the passed attributes.
<span class='line'>1802</span>   */</span><span class="WHIT">
<span class='line'>1803</span> </span><span class="WHIT">  </span><span class="NAME">localization</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">attrs</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">rootElement</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1804</span> </span><span class="WHIT">    </span><span class="COMM">// add rootElement</span><span class="WHIT">
<span class='line'>1805</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">rootElement</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">attrs.rootElement</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.$</span><span class="PUNC">(</span><span class="NAME">rootElement</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1806</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">attrs</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1807</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1808</span> 
<span class='line'>1809</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>1810</span>     Creates a view instance, first finding the DOM element you name and then
<span class='line'>1811</span>     using that as the root element.  You should not use this method very
<span class='line'>1812</span>     often, but it is sometimes useful if you want to attach to already
<span class='line'>1813</span>     existing HTML.
<span class='line'>1814</span> 
<span class='line'>1815</span>     @param {String|Element} element
<span class='line'>1816</span>     @param {Hash} attrs
<span class='line'>1817</span>     @returns {SC.View} instance
<span class='line'>1818</span>   */</span><span class="WHIT">
<span class='line'>1819</span> </span><span class="WHIT">  </span><span class="NAME">viewFor</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">element</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">attrs</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1820</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">args</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.$A</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// prepare to edit</span><span class="WHIT">
<span class='line'>1821</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.none</span><span class="PUNC">(</span><span class="NAME">element</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1822</span> </span><span class="WHIT">      </span><span class="NAME">args.shift</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// remove if no element passed</span><span class="WHIT">
<span class='line'>1823</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">args</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">rootElement</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">SC.$</span><span class="PUNC">(</span><span class="NAME">element</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1824</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.create.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1825</span> </span><span class="WHIT">    </span><span class="NAME">args</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">args</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1826</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1827</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1828</span> 
<span class='line'>1829</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>1830</span>     Create a new view with the passed attributes hash.  If you have the
<span class='line'>1831</span>     Designer module loaded, this will also create a peer designer if needed.
<span class='line'>1832</span>   */</span><span class="WHIT">
<span class='line'>1833</span> </span><span class="WHIT">  </span><span class="NAME">create</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1834</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">last</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">arguments.length</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1835</span> 
<span class='line'>1836</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">last</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">last.theme</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1837</span> </span><span class="WHIT">      </span><span class="NAME">last.themeName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">last.theme</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1838</span> </span><span class="WHIT">      </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">last.theme</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1839</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1840</span> 
<span class='line'>1841</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">C</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">C</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1842</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.ViewDesigner</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1843</span> </span><span class="WHIT">      </span><span class="NAME">SC.ViewDesigner.didCreateView</span><span class="PUNC">(</span><span class="NAME">ret</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">SC.$A</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1844</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1845</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ret</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1846</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1847</span> 
<span class='line'>1848</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>1849</span>     Applies the passed localization hash to the component views.  Call this
<span class='line'>1850</span>     method before you call create().  Returns the receiver.  Typically you
<span class='line'>1851</span>     will do something like this:
<span class='line'>1852</span> 
<span class='line'>1853</span>     view = SC.View.design({...}).loc(localizationHash).create();
<span class='line'>1854</span> 
<span class='line'>1855</span>     @param {Hash} loc
<span class='line'>1856</span>     @param rootElement {String} optional rootElement with prepped HTML
<span class='line'>1857</span>     @returns {SC.View} receiver
<span class='line'>1858</span>   */</span><span class="WHIT">
<span class='line'>1859</span> </span><span class="WHIT">  </span><span class="NAME">loc</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">loc</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1860</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">childLocs</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">loc.childViews</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1861</span> </span><span class="WHIT">    </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">loc.childViews</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// clear out child views before applying to attrs</span><span class="WHIT">
<span class='line'>1862</span> 
<span class='line'>1863</span> </span><span class="WHIT">    </span><span class="NAME">this.applyLocalizedAttributes</span><span class="PUNC">(</span><span class="NAME">loc</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1864</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.ViewDesigner</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1865</span> </span><span class="WHIT">      </span><span class="NAME">SC.ViewDesigner.didLoadLocalization</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">SC.$A</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1866</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1867</span> 
<span class='line'>1868</span> </span><span class="WHIT">    </span><span class="COMM">// apply localization recursively to childViews</span><span class="WHIT">
<span class='line'>1869</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">childViews</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.prototype.childViews</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">childViews.length</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1870</span> </span><span class="WHIT">      </span><span class="NAME">viewClass</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1871</span> </span><span class="WHIT">    </span><span class="KEYW">while</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">--</span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1872</span> </span><span class="WHIT">      </span><span class="NAME">viewClass</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">childViews</span><span class="PUNC">[</span><span class="NAME">idx</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1873</span> </span><span class="WHIT">      </span><span class="NAME">loc</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">childLocs</span><span class="PUNC">[</span><span class="NAME">idx</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1874</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">loc</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">viewClass</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">viewClass</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">SC.T_STRING</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">SC.String.loc</span><span class="PUNC">(</span><span class="NAME">viewClass</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">loc</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1875</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1876</span> 
<span class='line'>1877</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// done!</span><span class="WHIT">
<span class='line'>1878</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1879</span> 
<span class='line'>1880</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>1881</span>     Internal method actually updates the localized attributes on the view
<span class='line'>1882</span>     class.  This is overloaded in design mode to also save the attributes.
<span class='line'>1883</span>   */</span><span class="WHIT">
<span class='line'>1884</span> </span><span class="WHIT">  </span><span class="NAME">applyLocalizedAttributes</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">loc</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1885</span> </span><span class="WHIT">    </span><span class="NAME">SC.mixin</span><span class="PUNC">(</span><span class="NAME">this.prototype</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">loc</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1886</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1887</span> 
<span class='line'>1888</span> </span><span class="WHIT">  </span><span class="NAME">views</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1889</span> 
<span class='line'>1890</span> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1891</span> 
<span class='line'>1892</span> </span><span class="COMM">// .......................................................</span><span class="WHIT">
<span class='line'>1893</span> </span><span class="COMM">// OUTLET BUILDER</span><span class="WHIT">
<span class='line'>1894</span> </span><span class="COMM">//</span><span class="WHIT">
<span class='line'>1895</span> 
<span class='line'>1896</span> </span><span class="COMM">/**
<span class='line'>1897</span>   Generates a computed property that will look up the passed property path
<span class='line'>1898</span>   the first time you try to get the value.  Use this whenever you want to
<span class='line'>1899</span>   define an outlet that points to another view or object.  The root object
<span class='line'>1900</span>   used for the path will be the receiver.
<span class='line'>1901</span> */</span><span class="WHIT">
<span class='line'>1902</span> </span><span class="NAME">SC.outlet</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">path</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">root</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1903</span> </span><span class="WHIT">  </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1904</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.objectForPropertyPath</span><span class="PUNC">(</span><span class="NAME">path</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">root</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">root</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1905</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">.</span><span class="NAME">property</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1906</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1907</span> 
<span class='line'>1908</span> </span><span class="COMM">/** @private on unload clear cached divs. */</span><span class="WHIT">
<span class='line'>1909</span> </span><span class="NAME">SC.CoreView.unload</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1910</span> </span><span class="WHIT">  </span><span class="COMM">// delete view items this way to ensure the views are cleared.  The hash</span><span class="WHIT">
<span class='line'>1911</span> </span><span class="WHIT">  </span><span class="COMM">// itself may be owned by multiple view subclasses.</span><span class="WHIT">
<span class='line'>1912</span> </span><span class="WHIT">  </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">views</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.View.views</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1913</span> </span><span class="WHIT">  </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">views</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1914</span> </span><span class="WHIT">    </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">views</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1915</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">views.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1916</span> </span><span class="WHIT">      </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">views</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1917</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1918</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1919</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1920</span> 
<span class='line'>1921</span> </span><span class="COMM">/**
<span class='line'>1922</span>   @class
<span class='line'>1923</span> 
<span class='line'>1924</span>   Base class for managing a view.  Views provide two functions:
<span class='line'>1925</span> 
<span class='line'>1926</span>    1. They display – translating your application's state into drawing
<span class='line'>1927</span>      instructions for the web browser, and
<span class='line'>1928</span>    2. They react – acting as responders for incoming keyboard, mouse, and touch
<span class='line'>1929</span>      events.
<span class='line'>1930</span> 
<span class='line'>1931</span>   View Basics
<span class='line'>1932</span>   ====
<span class='line'>1933</span> 
<span class='line'>1934</span>   SproutCore's view layer is made up of a tree of SC.View instances, nested
<span class='line'>1935</span>   using the `childViews` list – usually an array of local property names. You
<span class='line'>1936</span>   position each view by specifying a set of layout keys, like 'left', 'right',
<span class='line'>1937</span>   'width', or 'centerX', in a hash on the layout property. (See the 'layout'
<span class='line'>1938</span>   documentation for more.)
<span class='line'>1939</span> 
<span class='line'>1940</span>   Other than positioning, SproutCore relies on CSS for all your styling needs.
<span class='line'>1941</span>   Set an array of CSS classes on the `classNames` property, then style them with
<span class='line'>1942</span>   standard CSS. (SproutCore's build tools come with Sass support built in, too.)
<span class='line'>1943</span>   If you have a class that you want automatically added and removed as another
<span class='line'>1944</span>   property changes, take a look at `classNameBindings`.
<span class='line'>1945</span> 
<span class='line'>1946</span>   Different view classes do different things. The so-called "Big Five" view
<span class='line'>1947</span>   classes are SC.LabelView, for displaying (optionally editable, optionally
<span class='line'>1948</span>   localizable) text; SC.ButtonView, for the user to poke; SC.CollectionView
<span class='line'>1949</span>   (most often as its subclass SC.ListView) for displaying an array of content;
<span class='line'>1950</span>   SC.ContainerView, for easily swapping child views in and out; and SC.ScrollView,
<span class='line'>1951</span>   for containing larger views and allowing them to be scrolled.
<span class='line'>1952</span> 
<span class='line'>1953</span>   All views live in panes (subclasses of SC.Pane, like SC.MainPane and SC.PanelPane),
<span class='line'>1954</span>   which are parentless views that know how to append themselves directly to the document.
<span class='line'>1955</span>   Panes also serve as routers for events, like mouse, touch and keyboard events, that are
<span class='line'>1956</span>   bound for their views. (See "View Events" below for more.)
<span class='line'>1957</span> 
<span class='line'>1958</span>   For best performance, you should define your view and pane instances with `extend()`
<span class='line'>1959</span>   inside an SC.Page instance, getting them as needed with `get`. As its name suggests,
<span class='line'>1960</span>   SC.Page's only job is to instantiate views once when first requested, deferring the
<span class='line'>1961</span>   expensive view creation process until each view is needed. Correctly using SC.Page is
<span class='line'>1962</span>   considered an important best practice for high-performance applications.
<span class='line'>1963</span> 
<span class='line'>1964</span>   View Initialization
<span class='line'>1965</span>   ====
<span class='line'>1966</span> 
<span class='line'>1967</span>   When a view is setup, there are several methods you can override that
<span class='line'>1968</span>   will be called at different times depending on how your view is created.
<span class='line'>1969</span>   Here is a guide to which method you want to override and when:
<span class='line'>1970</span> 
<span class='line'>1971</span>    - `init` -- override this method for any general object setup (such as
<span class='line'>1972</span>      observers, starting timers and animations, etc) that you need to happen
<span class='line'>1973</span>      every time the view is created, regardless of whether or not its layer
<span class='line'>1974</span>      exists yet.
<span class='line'>1975</span>    - `render` -- override this method to generate or update your HTML to reflect
<span class='line'>1976</span>      the current state of your view.  This method is called both when your view
<span class='line'>1977</span>      is first created and later anytime it needs to be updated.
<span class='line'>1978</span>    - `update` -- Normally, when a view needs to update its content, it will
<span class='line'>1979</span>      re-render the view using the render() method.  If you would like to
<span class='line'>1980</span>      override this behavior with your own custom updating code, you can
<span class='line'>1981</span>      replace update() with your own implementation instead.
<span class='line'>1982</span>    - `didCreateLayer` -- the render() method is used to generate new HTML.
<span class='line'>1983</span>      Override this method to perform any additional setup on the DOM you might
<span class='line'>1984</span>      need to do after creating the view.  For example, if you need to listen
<span class='line'>1985</span>      for events.
<span class='line'>1986</span>    - `willDestroyLayer` -- if you implement didCreateLayer() to setup event
<span class='line'>1987</span>      listeners, you should implement this method as well to remove the same
<span class='line'>1988</span>      just before the DOM for your view is destroyed.
<span class='line'>1989</span>    - `didAppendToDocument` -- in theory all DOM setup could be done
<span class='line'>1990</span>      in didCreateLayer() as you already have a DOM element instantiated.
<span class='line'>1991</span>      However there is cases where the element has to be first appended to the
<span class='line'>1992</span>      Document because there is either a bug on the browser or you are using
<span class='line'>1993</span>      plugins which objects are not instantiated until you actually append the
<span class='line'>1994</span>      element to the DOM. This will allow you to do things like registering
<span class='line'>1995</span>      DOM events on flash or quicktime objects.
<span class='line'>1996</span>    - `willRemoveFromDocument` -- This method is called on the view immediately
<span class='line'>1997</span>      before its layer is removed from the DOM. You can use this to reverse any
<span class='line'>1998</span>      setup that is performed in `didAppendToDocument`.
<span class='line'>1999</span> 
<span class='line'>2000</span>   View Events
<span class='line'>2001</span>   ====
<span class='line'>2002</span> 
<span class='line'>2003</span>   One of SproutCore's optimizations is application-wide event delegation: SproutCore
<span class='line'>2004</span>   handles and standardizes events for you before sending them through your view layer's
<span class='line'>2005</span>   chain of responding views. You should never need to attach event listeners to elements;
<span class='line'>2006</span>   instead, just implement methods like `click`, `doubleClick`, `mouseEntered` and
<span class='line'>2007</span>   `dataDragHover` on your views.
<span class='line'>2008</span> 
<span class='line'>2009</span>   Note that events generally bubble up an event's responder chain, which is made up of the
<span class='line'>2010</span>   targeted view (i.e. the view whose DOM element received the event), and its chain of
<span class='line'>2011</span>   parentViews up to its pane. (In certain rare cases, you may wish to manipulate the responder
<span class='line'>2012</span>   chain to bypass certain views; you can do so by overriding a view's `nextResponder` property.)
<span class='line'>2013</span> 
<span class='line'>2014</span>   Simple mouse click events
<span class='line'>2015</span>   ----
<span class='line'>2016</span>   In many situations, all you need are clicks - in which case, just implement `click` or
<span class='line'>2017</span>   `doubleClick` on your views. Note that these events bubble up the responder chain until
<span class='line'>2018</span>   they encounter a view which implements the event method. For example, if a view and its
<span class='line'>2019</span>   parent both implement `click`, the parent will not be notified of the click. (If you want a
<span class='line'>2020</span>   view to handle the event AND allow the event to keep bubbling to its parent views, no
<span class='line'>2021</span>   problem: just be sure to return NO from the event method.)
<span class='line'>2022</span>   - `click` -- Called on a view when the user clicks the mouse on a view. (Note that the view
<span class='line'>2023</span>     on which the user lifts the mouse button will receive the `click` event, regardless of
<span class='line'>2024</span>     whether the user depressed the mouse button elsewhere. If you need finer-grained control
<span class='line'>2025</span>     than this, see "Granular mouse click events" below.)
<span class='line'>2026</span>   - `doubleClick` -- Called on a view when a user has double-clicked it. Double-clicks are
<span class='line'>2027</span>     triggered when two clicks of the same button happen within eight pixels and 250ms of each
<span class='line'>2028</span>     other. (If you need finer-grained control than this, see "Granular mouse click events"
<span class='line'>2029</span>     below.) The same view may receive both `click` and `doubleClick` events.
<span class='line'>2030</span> 
<span class='line'>2031</span>   Note that defining application behavior directly in event handlers is usually a bad idea; you
<span class='line'>2032</span>   should follow the target/action pattern when possible. See SC.ButtonView and SC.ActionSupport.
<span class='line'>2033</span>   Also note that you will not need to implement event handling yourself on most built-in
<span class='line'>2034</span>   SproutCore controls.
<span class='line'>2035</span> 
<span class='line'>2036</span>   Note that `click` and `doubleClick` event handlers on your views will not be notified of touch
<span class='line'>2037</span>   events; you must also implement touch handling. See "Touch events" below.
<span class='line'>2038</span> 
<span class='line'>2039</span>   Mouse movement events
<span class='line'>2040</span>   ----
<span class='line'>2041</span>   SproutCore normalizes (and brings sanity to) mouse movement events by calculating when
<span class='line'>2042</span>   the mouse has entered and exited views, and sending the correct event to each view in
<span class='line'>2043</span>   the responder chain. For example, if a mouse moves within a parent view but crosses from
<span class='line'>2044</span>   one child view to another, the parent view will receive a mouseMoved event while the child
<span class='line'>2045</span>   views will receive mouseEntered and mouseExit events.
<span class='line'>2046</span> 
<span class='line'>2047</span>   In contrast to mouse click events, mouse movement events are called on the entire responder
<span class='line'>2048</span>   chain regardless of how you handle it along the way - a view and its parent, both implementing
<span class='line'>2049</span>   event methods, will both be notified of the event.
<span class='line'>2050</span> 
<span class='line'>2051</span>   - `mouseEntered` -- Called when the cursor first enters a view. Called on every view that has
<span class='line'>2052</span>     just entered the responder chain.
<span class='line'>2053</span>   - `mouseMoved` -- Called when the cursor moves over a view.
<span class='line'>2054</span>   - `mouseExited` -- Called when the cursor leaves a view. Called on every view that has
<span class='line'>2055</span>     just exited the responder chain.
<span class='line'>2056</span> 
<span class='line'>2057</span>   Granular mouse click events
<span class='line'>2058</span>   ----
<span class='line'>2059</span>   If you need more granular handling of mouse click events than what is provided by `click`
<span class='line'>2060</span>   and `doubleClick`, you can handle their atomic components `mouseDown`, `mouseDrag` and
<span class='line'>2061</span>   `mouseUp`. Like the compound events, these events bubble up their responder chain towards
<span class='line'>2062</span>   the pane until they find an event which implements the event handler method. (Again, to
<span class='line'>2063</span>   handle an event but allow it to continue bubbling, just return NO.)
<span class='line'>2064</span> 
<span class='line'>2065</span>   It bears emphasizing that `mouseDrag` and `mouseUp` events for a given mouse click sequence
<span class='line'>2066</span>   are *only ever called* on the view which successfully responded to the `mouseDown` event. This
<span class='line'>2067</span>   gives `mouseDown` control over which view responder-chain is allowed to handle the entire
<span class='line'>2068</span>   click sequence.
<span class='line'>2069</span> 
<span class='line'>2070</span>   (Note that because of how events bubble up the responder chain, if a child view implements
<span class='line'>2071</span>   `mouseDown` but not `mouseDrag` or `mouseUp`, those events will bubble to its parent. This
<span class='line'>2072</span>   may cause unexpected behavior if similar events are handled at different parts of your view
<span class='line'>2073</span>   hierarchy, for example if you handle `mouseDown` in a child and a parent, and only handle
<span class='line'>2074</span>   `mouseUp` in the parent.)
<span class='line'>2075</span> 
<span class='line'>2076</span>   - `mouseDown` -- Called on the target view and responder chain when the user depresses a
<span class='line'>2077</span>     button. A view must implement `mouseDown` (and not return NO) in order to be notified
<span class='line'>2078</span>     of the subsequent drag and up events.
<span class='line'>2079</span>   - `mouseDrag` -- Called on the target view if it handled mouseDown. A view must implement
<span class='line'>2080</span>     mouseDown (and not return NO) in order to receive mouseDrag; only the view which handled a
<span class='line'>2081</span>     given click sequence's mouseDown will receive `mouseDrag` events (and will continue to
<span class='line'>2082</span>     receive them even if the user drags the mouse off of it).
<span class='line'>2083</span>   - `mouseUp` -- Called on the target view when the user lifts a mouse button. A view must
<span class='line'>2084</span>     implement mouseDown (and not return NO) in order to receive mouseUp.
<span class='line'>2085</span> 
<span class='line'>2086</span>   SproutCore implements a higher-level API for handling in-application dragging and dropping.
<span class='line'>2087</span>   See `SC.Drag`, `SC.DragSourceProtocol`, `SC.DragDataSourceProtocol`, and `SC.DropTargetProtocol`
<span class='line'>2088</span>   for more.
<span class='line'>2089</span> 
<span class='line'>2090</span>   Data-drag events
<span class='line'>2091</span>   ----
<span class='line'>2092</span>   Browsers implement a parallel system of events for drags which bring something with them: for
<span class='line'>2093</span>   example, dragging text, an image, a URL or (in modern browsers) a file. They behave differently,
<span class='line'>2094</span>   and require different responses from the developer, so SproutCore implements them as a separate
<span class='line'>2095</span>   set of "data drag" events. These behave much like mouse events; the data-drag movement events
<span class='line'>2096</span>   bubble indiscriminately, and the data-drag drop event bubbles until it finds a view which handles
<span class='line'>2097</span>   it (and doesn't return NO).
<span class='line'>2098</span> 
<span class='line'>2099</span>   By default, SproutCore cancels the default behavior of any data drag event which carries URLs
<span class='line'>2100</span>   or files, as by default these would quit the app and open the dragged item in the browser. If
<span class='line'>2101</span>   you wish to implement data drag-and-drop support in your application, you should set the event's
<span class='line'>2102</span>   dataTransfer.dropEffect property to 'copy' in a `dataDragHovered` event handler.
<span class='line'>2103</span> 
<span class='line'>2104</span>   - `dataDragEntered` -- Triggered when a data drag enters a view. You can use this handler to
<span class='line'>2105</span>     update the view to visually signal that a drop is possible.
<span class='line'>2106</span>   - `dataDragHovered` -- Triggered when the browser sends a dragover event to a view. If you want
<span class='line'>2107</span>     to support dropping data on your view, you must set the event's `dataTransfer.dropEffect`
<span class='line'>2108</span>     property to 'copy' (or related). Note that `dataDragHovered` is given access to dragenter
<span class='line'>2109</span>     events as well, so you do not need to worry about this in your `dataDragEntered` methods.
<span class='line'>2110</span>   - `dataDragDropped` -- If the last hover event's dropEffect was set correctly, this event will
<span class='line'>2111</span>     give the view access to the data that was dropped. This event bubbles up the responder chain
<span class='line'>2112</span>     until it finds a view which handles it (and doesn't return NO).
<span class='line'>2113</span>   - `dataDragExited` -- Triggered when a data drag leaves a view. You can use this handler to
<span class='line'>2114</span>     update the view to remove the visual drop signal. This event is fired regardless of whether
<span class='line'>2115</span>     a drop occurred.
<span class='line'>2116</span> 
<span class='line'>2117</span> 
<span class='line'>2118</span>   Touch events
<span class='line'>2119</span>   ----
<span class='line'>2120</span>   Touch events can be much more complicated than mouse events: multiple touches may be in flight
<span class='line'>2121</span>   at once, and views may wish to handle average touches rather than individual touches.
<span class='line'>2122</span> 
<span class='line'>2123</span>   Basic support for touch events is required to make your application touch-aware. (You will not
<span class='line'>2124</span>   need to implement touch support for built-in SproutCore controls, which are touch-aware out of
<span class='line'>2125</span>   the box.) The basic touch event handlers are `touchStart` and `touchEnd`; if all you need is
<span class='line'>2126</span>   basic support then you can simply proxy these events to their mouse counterparts.
<span class='line'>2127</span> 
<span class='line'>2128</span>   The counterpart to `mouseDragged` is `touchesDragged`, which is passed two arguments: a special
<span class='line'>2129</span>   multitouch event object which includes methods for accessing information about all currently
<span class='line'>2130</span>   in-flight touches, and a list of touches active on the current view. If you need to check the
<span class='line'>2131</span>   status of touches currently being handled by other views, the special multitouch event object
<span class='line'>2132</span>   exposes the `touchesForView` method. It also exposes the convenient `averagedTouchesForView`
<span class='line'>2133</span>   method, which gives you easy access to an average touch center and distance. Unlike `mouseDragged`,
<span class='line'>2134</span>   `touchesDragged` does not bubble, being only called on views whic handled `touchStart` for touches
<span class='line'>2135</span>   which have moved.
<span class='line'>2136</span> 
<span class='line'>2137</span>   To facilitate intuitive behavior in situations like scroll views with touch handlers inside them,
<span class='line'>2138</span>   you may capture a touch from part way up its responder chain before it has a chance to bubble
<span class='line'>2139</span>   up from the target. To capture a touch, expose a method on your view called `captureTouch` which
<span class='line'>2140</span>   accepts the touch as its only argument, and which returns YES if you would like to capture that
<span class='line'>2141</span>   touch. A captured touch will not bubble as normal, instead bubbling up from the capture point. Any
<span class='line'>2142</span>   child views will not have the opportunity to handle the captured event unless you implement custom
<span class='line'>2143</span>   responder swapping yourself.
<span class='line'>2144</span> 
<span class='line'>2145</span>   Touch events bubble differently than mouse and keyboard events. The initial reverse `captureTouch`
<span class='line'>2146</span>   bubbling is followed by regular `touchStart` bubbling; however, once this process has found a view
<span class='line'>2147</span>   that's willing to respond to the touch, further events are applied only to that view. If a view
<span class='line'>2148</span>   wishes to assign respondership for a touch to a different view, it can call one of several methods
<span class='line'>2149</span>   on the touch object. For a fuller discussion of touch events, touch responder behavior, and the touch
<span class='line'>2150</span>   object itself, see the documentation for SC.Touch.
<span class='line'>2151</span> 
<span class='line'>2152</span>   Keyboard events
<span class='line'>2153</span>   ----
<span class='line'>2154</span>   The basic key events are `keyDown` and `keyUp`. In order to be notified of keyboard events,
<span class='line'>2155</span>   a view must set `acceptsFirstResponder` to `YES`, and be on an active pane with
<span class='line'>2156</span>   `acceptsKeyPane` set to YES. (You may also need to call `becomeFirstResponder` on your view
<span class='line'>2157</span>   on a `mouseDown`, for example, to focus it. You can verify whether your view has successfully
<span class='line'>2158</span>   received first responder status by checking `isFirstResponder`.)
<span class='line'>2159</span> 
<span class='line'>2160</span>   Note that key events bubble similarly to mouse click events: they will stop bubbling if they
<span class='line'>2161</span>   encounter a view which handles the event and does not return NO.
<span class='line'>2162</span> 
<span class='line'>2163</span>   SproutCore implements a set of very convenient, higher-level keyboard events for action keys
<span class='line'>2164</span>   such as *tab*, *enter*, and the arrow keys. These are not triggered automatically, but you
<span class='line'>2165</span>   can gain access to them by proxying the keyboard event of your choice to `interpretKeyEvent`.
<span class='line'>2166</span>   For example:
<span class='line'>2167</span> 
<span class='line'>2168</span>         // Proxy the keyboard event to SC's built-in interpreter.
<span class='line'>2169</span>         keyDown: function(evt) {
<span class='line'>2170</span>           return this.interpretKeyEvents(evt);
<span class='line'>2171</span>         },
<span class='line'>2172</span>         // The interpreter will trigger the view's `cancel` event if the escape key was pressed.
<span class='line'>2173</span>         cancel: function(evt) {
<span class='line'>2174</span>           console.log('The escape key was pressed.'');
<span class='line'>2175</span>         }
<span class='line'>2176</span> 
<span class='line'>2177</span>   This will analyze the key press and fire an appropriate event. These events include, but are
<span class='line'>2178</span>   not limited to:
<span class='line'>2179</span> 
<span class='line'>2180</span>   - `moveUp`, `moveDown`, `moveLeft`, `moveRight` -- The arrow keys
<span class='line'>2181</span>   - `insertNewline` -- The enter key (note the lower-case 'line')
<span class='line'>2182</span>   - `cancel` -- The escape key
<span class='line'>2183</span>   - `insertTab` -- The tab key
<span class='line'>2184</span>   - `insertBacktab` -- Shift + the tab key
<span class='line'>2185</span>   - `moveToBeginningOfDocument` -- The *home* key
<span class='line'>2186</span>   - `moveToEndOfDocument` -- The *end* key
<span class='line'>2187</span>   - `pageUp` and `pageDown`
<span class='line'>2188</span>   - `moveLeftAndModifySelection` -- Shift + the left arrow
<span class='line'>2189</span>   - `selectAll` -- Ctrl + A / Cmd + A
<span class='line'>2190</span> 
<span class='line'>2191</span>   For a full list of available methods, see the key values on SC.BASE_KEY_BINDINGS and
<span class='line'>2192</span>   SC.MODIFIED_KEY_BINDINGS.
<span class='line'>2193</span> 
<span class='line'>2194</span>   @extends SC.Responder
<span class='line'>2195</span>   @extends SC.DelegateSupport
<span class='line'>2196</span>   @since SproutCore 1.0
<span class='line'>2197</span> 
<span class='line'>2198</span> */</span><span class="WHIT">
<span class='line'>2199</span> </span><span class="NAME">SC.View</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.CoreView.extend</span><span class="PUNC">(</span><span class="COMM">/** @scope SC.View.prototype */</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2200</span> </span><span class="WHIT">  </span><span class="NAME">classNames</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="STRN">'sc-view'</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2201</span> 
<span class='line'>2202</span> </span><span class="WHIT">  </span><span class="NAME">displayProperties</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2203</span> 
<span class='line'>2204</span> </span><span class="WHIT">  </span><span class="COMM">/** @private Enhance. */</span><span class="WHIT">
<span class='line'>2205</span> </span><span class="WHIT">  </span><span class="NAME">_executeQueuedUpdates</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2206</span> </span><span class="WHIT">    </span><span class="NAME">sc_super</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2207</span> 
<span class='line'>2208</span> </span><span class="WHIT">    </span><span class="COMM">// Enabled</span><span class="WHIT">
<span class='line'>2209</span> </span><span class="WHIT">    </span><span class="COMM">// Update the layout style of the layer if necessary.</span><span class="WHIT">
<span class='line'>2210</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._enabledStyleNeedsUpdate</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2211</span> </span><span class="WHIT">      </span><span class="NAME">this._doUpdateEnabledStyle</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2212</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2213</span> 
<span class='line'>2214</span> </span><span class="WHIT">    </span><span class="COMM">// Layout</span><span class="WHIT">
<span class='line'>2215</span> </span><span class="WHIT">    </span><span class="COMM">// Update the layout style of the layer if necessary.</span><span class="WHIT">
<span class='line'>2216</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._layoutStyleNeedsUpdate</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2217</span> </span><span class="WHIT">      </span><span class="NAME">this._doUpdateLayoutStyle</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2218</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2219</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2220</span> 
<span class='line'>2221</span> </span><span class="WHIT">  </span><span class="COMM">/** Apply the attributes to the context. */</span><span class="WHIT">
<span class='line'>2222</span> </span><span class="WHIT">  </span><span class="NAME">applyAttributesToContext</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">context</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2223</span> </span><span class="WHIT">    </span><span class="COMM">// Cursor</span><span class="WHIT">
<span class='line'>2224</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">cursor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'cursor'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2225</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">cursor</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">context.addClass</span><span class="PUNC">(</span><span class="NAME">cursor.get</span><span class="PUNC">(</span><span class="STRN">'className'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2226</span> 
<span class='line'>2227</span> </span><span class="WHIT">    </span><span class="COMM">// Enabled</span><span class="WHIT">
<span class='line'>2228</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'isEnabled'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2229</span> </span><span class="WHIT">      </span><span class="NAME">context.addClass</span><span class="PUNC">(</span><span class="STRN">'disabled'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2230</span> </span><span class="WHIT">      </span><span class="NAME">context.setAttr</span><span class="PUNC">(</span><span class="STRN">'aria-disabled'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'true'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2231</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2232</span> 
<span class='line'>2233</span> </span><span class="WHIT">    </span><span class="COMM">// Layout</span><span class="WHIT">
<span class='line'>2234</span> </span><span class="WHIT">    </span><span class="COMM">// Have to pass 'true' for second argument for legacy.</span><span class="WHIT">
<span class='line'>2235</span> </span><span class="WHIT">    </span><span class="NAME">this.renderLayout</span><span class="PUNC">(</span><span class="NAME">context</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2236</span> 
<span class='line'>2237</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'useStaticLayout'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">context.addClass</span><span class="PUNC">(</span><span class="STRN">'sc-static-layout'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2238</span> 
<span class='line'>2239</span> </span><span class="WHIT">    </span><span class="COMM">// Background color defaults to null; for performance reasons we should ignore it</span><span class="WHIT">
<span class='line'>2240</span> </span><span class="WHIT">    </span><span class="COMM">// unless it's ever been non-null.</span><span class="WHIT">
<span class='line'>2241</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">backgroundColor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'backgroundColor'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2242</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">SC.none</span><span class="PUNC">(</span><span class="NAME">backgroundColor</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this._scv_hasBackgroundColor</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2243</span> </span><span class="WHIT">      </span><span class="NAME">this._scv_hasBackgroundColor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">YES</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2244</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">backgroundColor</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">context.setStyle</span><span class="PUNC">(</span><span class="STRN">'backgroundColor'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">backgroundColor</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2245</span> </span><span class="WHIT">      </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">context.removeStyle</span><span class="PUNC">(</span><span class="STRN">'backgroundColor'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2246</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2247</span> 
<span class='line'>2248</span> </span><span class="WHIT">    </span><span class="COMM">// Theming</span><span class="WHIT">
<span class='line'>2249</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">theme</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'theme'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2250</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">themeClassNames</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">theme.classNames</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">themeClassNames.length</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2251</span> 
<span class='line'>2252</span> </span><span class="WHIT">    </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2253</span> </span><span class="WHIT">      </span><span class="NAME">context.addClass</span><span class="PUNC">(</span><span class="NAME">themeClassNames</span><span class="PUNC">[</span><span class="NAME">idx</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2254</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2255</span> 
<span class='line'>2256</span> </span><span class="WHIT">    </span><span class="NAME">sc_super</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2257</span> 
<span class='line'>2258</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">renderDelegate</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'renderDelegate'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2259</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">renderDelegate</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">renderDelegate.className</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2260</span> </span><span class="WHIT">      </span><span class="NAME">context.addClass</span><span class="PUNC">(</span><span class="NAME">renderDelegate.className</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2261</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2262</span> 
<span class='line'>2263</span> </span><span class="WHIT">    </span><span class="COMM">// @if(debug)</span><span class="WHIT">
<span class='line'>2264</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">renderDelegate</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">renderDelegate.name</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2265</span> </span><span class="WHIT">      </span><span class="NAME">SC.Logger.error</span><span class="PUNC">(</span><span class="STRN">"Render delegates now use 'className' instead of 'name'."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2266</span> </span><span class="WHIT">      </span><span class="NAME">SC.Logger.error</span><span class="PUNC">(</span><span class="STRN">"Name '%@' will be ignored."</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">renderDelegate.name</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2267</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2268</span> </span><span class="WHIT">    </span><span class="COMM">// @endif</span><span class="WHIT">
<span class='line'>2269</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2270</span> 
<span class='line'>2271</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='line'>2272</span>     Computes what the frame of this view would be if the parent were resized
<span class='line'>2273</span>     to the passed dimensions.  You can use this method to project the size of
<span class='line'>2274</span>     a frame based on the resize behavior of the parent.
<span class='line'>2275</span> 
<span class='line'>2276</span>     This method is used especially by the scroll view to automatically
<span class='line'>2277</span>     calculate when scrollviews should be visible.
<span class='line'>2278</span> 
<span class='line'>2279</span>     Passing null for the parent dimensions will use the actual current
<span class='line'>2280</span>     parent dimensions.  This is the same method used to calculate the current
<span class='line'>2281</span>     frame when it changes.
<span class='line'>2282</span> 
<span class='line'>2283</span>     @param {Rect} pdim the projected parent dimensions (optional)
<span class='line'>2284</span>     @returns {Rect} the computed frame
<span class='line'>2285</span>   */</span><span class="WHIT">
<span class='line'>2286</span> </span><span class="WHIT">  </span><span class="NAME">computeFrameWithParentFrame</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">pdim</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2287</span> </span><span class="WHIT">    </span><span class="COMM">// Layout.</span><span class="WHIT">
<span class='line'>2288</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">layout</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'layout'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2289</span> </span><span class="WHIT">        </span><span class="NAME">f</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2290</span> 
<span class='line'>2291</span> </span><span class="WHIT">    </span><span class="COMM">// We can't predict the frame for static layout, so just return the view's</span><span class="WHIT">
<span class='line'>2292</span> </span><span class="WHIT">    </span><span class="COMM">// current frame (see original computeFrameWithParentFrame in views/view.js)</span><span class="WHIT">
<span class='line'>2293</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'useStaticLayout'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2294</span> </span><span class="WHIT">      </span><span class="NAME">f</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">sc_super</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2295</span> </span><span class="WHIT">      </span><span class="NAME">f</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">f</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this._adjustForBorder</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">layout</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2296</span> </span><span class="WHIT">      </span><span class="NAME">f</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">f</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this._adjustForScale</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">layout</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2297</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2298</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2299</span> 
<span class='line'>2300</span> </span><span class="WHIT">    </span><span class="NAME">f</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2301</span> 
<span class='line'>2302</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">error</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">layer</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">AUTO</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.LAYOUT_AUTO</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2303</span> </span><span class="WHIT">        </span><span class="NAME">dH</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">dW</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="COMM">//shortHand for parentDimensions</span><span class="WHIT">
<span class='line'>2304</span> </span><span class="WHIT">        </span><span class="NAME">lR</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">layout.right</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2305</span> </span><span class="WHIT">        </span><span class="NAME">lL</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">layout.left</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2306</span> </span><span class="WHIT">        </span><span class="NAME">lT</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">layout.top</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2307</span> </span><span class="WHIT">        </span><span class="NAME">lB</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">layout.bottom</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2308</span> </span><span class="WHIT">        </span><span class="NAME">lW</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">layout.width</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2309</span> </span><span class="WHIT">        </span><span class="NAME">lH</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">layout.height</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2310</span> </span><span class="WHIT">        </span><span class="NAME">lcX</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">layout.centerX</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2311</span> </span><span class="WHIT">        </span><span class="NAME">lcY</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">layout.centerY</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2312</span> 
<span class='line'>2313</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">lW</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">AUTO</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2314</span> </span><span class="WHIT">      </span><span class="NAME">error</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.Error.desc</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="STRN">"%@.layout() cannot use width:auto if staticLayout is disabled"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">fmt</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"%@"</span><span class="PUNC">.</span><span class="NAME">fmt</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2315</span> </span><span class="WHIT">      </span><span class="NAME">SC.Logger.error</span><span class="PUNC">(</span><span class="NAME">error.toString</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2316</span> </span><span class="WHIT">      </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="NAME">error</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2317</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2318</span> 
<span class='line'>2319</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">lH</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">AUTO</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2320</span> </span><span class="WHIT">      </span><span class="NAME">error</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">SC.Error.desc</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="STRN">"%@.layout() cannot use height:auto if staticLayout is disabled"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">fmt</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">"%@"</span><span class="PUNC">.</span><span class="NAME">fmt</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2321</span> </span><span class="WHIT">      </span><span class="NAME">SC.Logger.error</span><span class="PUNC">(</span><span class="NAME">error.toString</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2322</span> </span><span class="WHIT">      </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="NAME">error</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2323</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2324</span> 
<span class='line'>2325</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">pdim</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">pdim</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.computeParentDimensions</span><span class="PUNC">(</span><span class="NAME">layout</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2326</span> </span><span class="WHIT">    </span><span class="NAME">dH</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">pdim.height</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2327</span> </span><span class="WHIT">    </span><span class="NAME">dW</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">pdim.width</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2328</span> 
<span class='line'>2329</span> </span><span class="WHIT">    </span><span class="COMM">// handle left aligned and left/right</span><span class="WHIT">
<span class='line'>2330</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">SC.none</span><span class="PUNC">(</span><span class="NAME">lL</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2331</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.isPercentage</span><span class="PUNC">(</span><span class="NAME">lL</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2332</span> </span><span class="WHIT">        </span><span class="NAME">f.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">dW</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">lL</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2333</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2334</span> </span><span class="WHIT">        </span><span class="NAME">f.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">lL</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2335</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2336</span> 
<span class='line'>2337</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">lW</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2338</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">lW</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">AUTO</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">f.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">AUTO</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2339</span> </span><span class="WHIT">        </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.isPercentage</span><span class="PUNC">(</span><span class="NAME">lW</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">f.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">dW</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">lW</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2340</span> </span><span class="WHIT">        </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">f.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">lW</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2341</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// better have lR!</span><span class="WHIT">
<span class='line'>2342</span> </span><span class="WHIT">        </span><span class="NAME">f.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">dW</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">f.x</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2343</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">lR</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">SC.isPercentage</span><span class="PUNC">(</span><span class="NAME">lR</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">f.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">f.width</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">lR</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">dW</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2344</span> </span><span class="WHIT">        </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">f.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">f.width</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">lR</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2345</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2346</span> 
<span class='line'>2347</span> </span><span class="WHIT">    </span><span class="COMM">// handle right aligned</span><span class="WHIT">
<span class='line'>2348</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">SC.none</span><span class="PUNC">(</span><span class="NAME">lR</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2349</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.none</span><span class="PUNC">(</span><span class="NAME">lW</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2350</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.isPercentage</span><span class="PUNC">(</span><span class="NAME">lR</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2351</span> </span><span class="WHIT">          </span><span class="NAME">f.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">dW</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">dW</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">lR</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2352</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2353</span> </span><span class="WHIT">        </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">f.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">dW</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">lR</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2354</span> </span><span class="WHIT">        </span><span class="NAME">f.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2355</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2356</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">lW</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">AUTO</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">f.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">AUTO</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2357</span> </span><span class="WHIT">        </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.isPercentage</span><span class="PUNC">(</span><span class="NAME">lW</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">f.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">dW</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">lW</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2358</span> </span><span class="WHIT">        </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">f.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">lW</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2359</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.isPercentage</span><span class="PUNC">(</span><span class="NAME">lW</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">f.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">dW</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">lR</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">dW</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">f.width</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2360</span> </span><span class="WHIT">        </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">f.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">dW</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">lR</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">f.width</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2361</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2362</span> 
<span class='line'>2363</span> </span><span class="WHIT">    </span><span class="COMM">// handle centered</span><span class="WHIT">
<span class='line'>2364</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">SC.none</span><span class="PUNC">(</span><span class="NAME">lcX</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2365</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">lW</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">AUTO</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">f.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">AUTO</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2366</span> </span><span class="WHIT">      </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.isPercentage</span><span class="PUNC">(</span><span class="NAME">lW</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">f.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">lW</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">dW</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2367</span> </span><span class="WHIT">      </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">f.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">lW</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2368</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.isPercentage</span><span class="PUNC">(</span><span class="NAME">lcX</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">f.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">dW</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">f.width</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">/</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">lcX</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">dW</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2369</span> </span><span class="WHIT">      </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">f.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">dW</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">f.width</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">/</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">lcX</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2370</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2371</span> </span><span class="WHIT">      </span><span class="NAME">f.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// fallback</span><span class="WHIT">
<span class='line'>2372</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.none</span><span class="PUNC">(</span><span class="NAME">lW</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2373</span> </span><span class="WHIT">        </span><span class="NAME">f.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">dW</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2374</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2375</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">lW</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">AUTO</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">f.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">AUTO</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2376</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.isPercentage</span><span class="PUNC">(</span><span class="NAME">lW</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">f.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">lW</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">dW</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2377</span> </span><span class="WHIT">        </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">f.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">lW</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2378</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2379</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2380</span> 
<span class='line'>2381</span> </span><span class="WHIT">    </span><span class="COMM">// handle top aligned and top/bottom</span><span class="WHIT">
<span class='line'>2382</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">SC.none</span><span class="PUNC">(</span><span class="NAME">lT</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2383</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.isPercentage</span><span class="PUNC">(</span><span class="NAME">lT</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">f.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">lT</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">dH</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2384</span> </span><span class="WHIT">      </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">f.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">lT</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2385</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">lH</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2386</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">lH</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">AUTO</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">f.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">AUTO</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2387</span> </span><span class="WHIT">        </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.isPercentage</span><span class="PUNC">(</span><span class="NAME">lH</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">f.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">lH</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">dH</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2388</span> </span><span class="WHIT">        </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">f.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">lH</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2389</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// better have lB!</span><span class="WHIT">
<span class='line'>2390</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">lB</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">SC.isPercentage</span><span class="PUNC">(</span><span class="NAME">lB</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">f.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">dH</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">f.y</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">lB</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">dH</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2391</span> </span><span class="WHIT">        </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">f.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">dH</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">f.y</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">lB</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2392</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2393</span> 
<span class='line'>2394</span> </span><span class="WHIT">    </span><span class="COMM">// handle bottom aligned</span><span class="WHIT">
<span class='line'>2395</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">SC.none</span><span class="PUNC">(</span><span class="NAME">lB</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2396</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.none</span><span class="PUNC">(</span><span class="NAME">lH</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2397</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.isPercentage</span><span class="PUNC">(</span><span class="NAME">lB</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">f.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">dH</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">lB</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">dH</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2398</span> </span><span class="WHIT">        </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">f.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">dH</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">lB</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2399</span> </span><span class="WHIT">        </span><span class="NAME">f.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2400</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2401</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">lH</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">AUTO</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">f.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">AUTO</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2402</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">lH</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">SC.isPercentage</span><span class="PUNC">(</span><span class="NAME">lH</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">f.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">lH</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">dH</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2403</span> </span><span class="WHIT">        </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">f.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">lH</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2404</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.isPercentage</span><span class="PUNC">(</span><span class="NAME">lB</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">f.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">dH</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">lB</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">dH</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">f.height</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2405</span> </span><span class="WHIT">        </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">f.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">dH</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">lB</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">f.height</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2406</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2407</span> 
<span class='line'>2408</span> </span><span class="WHIT">    </span><span class="COMM">// handle centered</span><span class="WHIT">
<span class='line'>2409</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">SC.none</span><span class="PUNC">(</span><span class="NAME">lcY</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2410</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">lH</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">AUTO</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">f.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">AUTO</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2411</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">lH</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">SC.isPercentage</span><span class="PUNC">(</span><span class="NAME">lH</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">f.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">lH</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">dH</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2412</span> </span><span class="WHIT">      </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">f.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">lH</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2413</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.isPercentage</span><span class="PUNC">(</span><span class="NAME">lcY</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">f.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">dH</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">f.height</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">/</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">lcY</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">dH</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2414</span> </span><span class="WHIT">      </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">f.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">dH</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">f.height</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">/</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">lcY</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2415</span> 
<span class='line'>2416</span> </span><span class="WHIT">    </span><span class="COMM">// fallback</span><span class="WHIT">
<span class='line'>2417</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2418</span> </span><span class="WHIT">      </span><span class="NAME">f.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// fallback</span><span class="WHIT">
<span class='line'>2419</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.none</span><span class="PUNC">(</span><span class="NAME">lH</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2420</span> </span><span class="WHIT">        </span><span class="NAME">f.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">dH</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2421</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2422</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">lH</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">AUTO</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">f.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">AUTO</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2423</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.isPercentage</span><span class="PUNC">(</span><span class="NAME">lH</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">f.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">lH</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">dH</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2424</span> </span><span class="WHIT">        </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">f.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">lH</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2425</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2426</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2427</span> 
<span class='line'>2428</span> </span><span class="WHIT">    </span><span class="NAME">f.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">f.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2429</span> </span><span class="WHIT">    </span><span class="NAME">f.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">f.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2430</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">f.height</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">AUTO</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">f.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">f.height</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2431</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">f.width</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">AUTO</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">f.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">f.width</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2432</span> 
<span class='line'>2433</span> </span><span class="WHIT">    </span><span class="COMM">// if width or height were set to auto and we have a layer, try lookup</span><span class="WHIT">
<span class='line'>2434</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">f.height</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">AUTO</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">f.width</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">AUTO</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2435</span> </span><span class="WHIT">      </span><span class="NAME">layer</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'layer'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2436</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">f.height</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">AUTO</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">f.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">layer</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">layer.clientHeight</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2437</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">f.width</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">AUTO</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">f.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">layer</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">layer.clientWidth</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2438</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2439</span> 
<span class='line'>2440</span> </span><span class="WHIT">    </span><span class="COMM">// Okay we have all our numbers. Let's adjust them for things.</span><span class="WHIT">
<span class='line'>2441</span> 
<span class='line'>2442</span> </span><span class="WHIT">    </span><span class="COMM">// First, adjust for border.</span><span class="WHIT">
<span class='line'>2443</span> </span><span class="WHIT">    </span><span class="NAME">f</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._adjustForBorder</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">layout</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2444</span> 
<span class='line'>2445</span> </span><span class="WHIT">    </span><span class="COMM">// Make sure the width/height fix their min/max (note the inlining of SC.none for performance)...</span><span class="WHIT">
<span class='line'>2446</span> </span><span class="WHIT">    </span><span class="COMM">/*jshint eqnull:true */</span><span class="WHIT">
<span class='line'>2447</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">layout.maxHeight</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">f.height</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">layout.maxHeight</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">f.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">layout.maxHeight</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2448</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">layout.minHeight</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">f.height</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">layout.minHeight</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">f.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">layout.minHeight</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2449</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">layout.maxWidth</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">f.width</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">layout.maxWidth</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">f.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">layout.maxWidth</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2450</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">layout.minWidth</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">f.width</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">layout.minWidth</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">f.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">layout.minWidth</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2451</span> 
<span class='line'>2452</span> </span><span class="WHIT">    </span><span class="COMM">// Finally, adjust for scale.</span><span class="WHIT">
<span class='line'>2453</span> </span><span class="WHIT">    </span><span class="NAME">f</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._adjustForScale</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">layout</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2454</span> 
<span class='line'>2455</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2456</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2457</span> 
<span class='line'>2458</span> </span><span class="WHIT">  </span><span class="NAME">init</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2459</span> </span><span class="WHIT">    </span><span class="NAME">sc_super</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2460</span> 
<span class='line'>2461</span> </span><span class="WHIT">    </span><span class="COMM">// Enabled.</span><span class="WHIT">
<span class='line'>2462</span> </span><span class="WHIT">    </span><span class="COMM">// If the view is pre-configured as disabled, then go to the proper initial state.</span><span class="WHIT">
<span class='line'>2463</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'isEnabled'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this._doDisable</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2464</span> 
<span class='line'>2465</span> </span><span class="WHIT">    </span><span class="COMM">// Layout</span><span class="WHIT">
<span class='line'>2466</span> </span><span class="WHIT">    </span><span class="NAME">this._previousLayout</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'layout'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2467</span> 
<span class='line'>2468</span> </span><span class="WHIT">    </span><span class="COMM">// Apply the automatic child view layout if it is defined.</span><span class="WHIT">
<span class='line'>2469</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">childViewLayout</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.childViewLayout</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2470</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">childViewLayout</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2471</span> </span><span class="WHIT">      </span><span class="COMM">// Layout the child views once.</span><span class="WHIT">
<span class='line'>2472</span> </span><span class="WHIT">      </span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="STRN">'childViewsNeedLayout'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2473</span> </span><span class="WHIT">      </span><span class="NAME">this.layoutChildViewsIfNeeded</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2474</span> 
<span class='line'>2475</span> </span><span class="WHIT">      </span><span class="COMM">// If the child view layout is live, start observing affecting properties.</span><span class="WHIT">
<span class='line'>2476</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'isChildViewLayoutLive'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2477</span> </span><span class="WHIT">        </span><span class="NAME">this.addObserver</span><span class="PUNC">(</span><span class="STRN">'childViews.[]'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._cvl_childViewsDidChange</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2478</span> </span><span class="WHIT">        </span><span class="COMM">// DISABLED. this.addObserver('childViewLayout', this, this._cvl_childViewLayoutDidChange);</span><span class="WHIT">
<span class='line'>2479</span> </span><span class="WHIT">        </span><span class="NAME">this.addObserver</span><span class="PUNC">(</span><span class="STRN">'childViewLayoutOptions'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._cvl_childViewLayoutDidChange</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2480</span> 
<span class='line'>2481</span> </span><span class="WHIT">        </span><span class="COMM">// Initialize the child views.</span><span class="WHIT">
<span class='line'>2482</span> </span><span class="WHIT">        </span><span class="NAME">this._cvl_setupChildViewsLiveLayout</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2483</span> 
<span class='line'>2484</span> </span><span class="WHIT">        </span><span class="COMM">// Initialize our own frame observer.</span><span class="WHIT">
<span class='line'>2485</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'isFixedSize'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">childViewLayout.layoutDependsOnSize</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">childViewLayout.layoutDependsOnSize</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2486</span> </span><span class="WHIT">          </span><span class="NAME">this.addObserver</span><span class="PUNC">(</span><span class="STRN">'frame'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._cvl_childViewLayoutDidChange</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2487</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2488</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2489</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2490</span> 
<span class='line'>2491</span> </span><span class="WHIT">    </span><span class="COMM">// Theming</span><span class="WHIT">
<span class='line'>2492</span> </span><span class="WHIT">    </span><span class="NAME">this._lastTheme</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.get</span><span class="PUNC">(</span><span class="STRN">'theme'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2493</span> 
<span class='line'>2494</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2495</span> 
<span class='line'>2496</span> </span><span class="WHIT">  </span><span class="COMM">/** @private */</span><span class="WHIT">
<span class='line'>2497</span> </span><span class="WHIT">  </span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2498</span> </span><span class="WHIT">    </span><span class="COMM">// Clean up.</span><span class="WHIT">
<span class='line'>2499</span> </span><span class="WHIT">    </span><span class="NAME">this._previousLayout</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2500</span> 
<span class='line'>2501</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">sc_super</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2502</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2503</span> 
<span class='line'>2504</span> </span><span class="WHIT">  </span><span class="COMM">/** SC.CoreView.prototype. */</span><span class="WHIT">
<span class='line'>2505</span> </span><span class="WHIT">  </span><span class="NAME">removeChild</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2506</span> </span><span class="WHIT">    </span><span class="COMM">// Manipulation</span><span class="WHIT">
<span class='line'>2507</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">view</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="COMM">// nothing to do</span><span class="WHIT">
<span class='line'>2508</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">view.parentView</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2509</span> </span><span class="WHIT">      </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">"%@.removeChild(%@) must belong to parent"</span><span class="PUNC">.</span><span class="NAME">fmt</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">view</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2510</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2511</span> 
<span class='line'>2512</span> </span><span class="WHIT">    </span><span class="COMM">// notify views</span><span class="WHIT">
<span class='line'>2513</span> </span><span class="WHIT">    </span><span class="COMM">// TODO: Deprecate these notifications.</span><span class="WHIT">
<span class='line'>2514</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">view.willRemoveFromParent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">view.willRemoveFromParent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2515</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.willRemoveChild</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this.willRemoveChild</span><span class="PUNC">(</span><span class="NAME">view</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2516</span> 
<span class='line'>2517</span> </span><span class="WHIT">    </span><span class="NAME">sc_super</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2518</span> 
<span class='line'>2519</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2520</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2521</span> 
<span class='line'>2522</span> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2523</span> 
<span class='line'>2524</span> </span><span class="COMM">//unload views for IE, trying to collect memory.</span><span class="WHIT">
<span class='line'>2525</span> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">SC.browser.isIE</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">SC.Event.add</span><span class="PUNC">(</span><span class="NAME">window</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'unload'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">SC.View</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">SC.View.unload</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2526</span> 
<span class='line'>2527</span> 
<span class='line'>2528</span> </span></pre></body></html>